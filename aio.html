<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Introduction to developing software in a team for Astronomers: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><!--
    <link rel="apple-touch-icon" sizes="180x180" href="favicons/swc/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicons/swc/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicons/swc/favicon-16x16.png">
    --><link rel="icon" type="image/png" href="favicons/ADACS_icon.png">
<link rel="manifest" href="favicons/swc/site.webmanifest">
<link rel="mask-icon" href="favicons/swc/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav software"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="swc-logo" alt="Collaborative software development" src="assets/images/adacs_logo_dark.png">
</div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>


      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav software" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Collaborative software development" src="assets/images/software-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Introduction to developing software in a team for Astronomers
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Introduction to developing software in a team for Astronomers
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to developing software in a team for Astronomers
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress software">
    <div class="progress-bar software" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. Introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="PoC.html">2. Coding Up A Proof Of Concept</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="DevInATeam.html">3. Developing Software In A Team</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="ReusableCode.html">4. Making Code Reusable by You and Your Group</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="TestAndDoc.html">5. Testing and Documenting Code</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="AutomationAndCI.html">6. Automation and Continuous Integration (on GitHub)</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="SharingCode.html">7. Sharing Code To The Wider Community</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->


                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">Introduction</a></p>
<hr>
<p>Last updated on 2026-02-25 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<section><h2 class="section-heading" id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<hr class="half-width">
<p>Writing software is an integral component of the research activities
of many astronomers. Increasingly, such software is written in
collaborative efforts involving multiple researchers across multiple
institutions. Despite this, training for astronomy students and early
career researchers in best practices for collaborative software
development is often informal and fails to make use of software industry
knowledge. The goal of this course is to fill this training gap.</p>
<p>In this course you will be guided through the development of a
software package, beginning at proof of concept, and finishing with a
project that is findable, accessible, interoperable, reusable (FAIR),
and citable by others. This course is presented in lessons which
represent development <strong>cycles</strong>. Each cycle will be
another step along the path of making code that you are proud of and can
be recognised for.</p>
<p>You can engage with this course as a reading assignment but we
recommend that you follow along at home by applying all the lessons
learned to your own software project. This course is designed with
<strong>collaborative</strong> software development in mind. Throughout
the course there will be self paced ungraded activities to complete that
will be marked as either SOLO or GROUP activities. If you are joining
this course as part of a group wishing to improve your collaborative
software development skills then you should aim to complete all the
activities. If you are joining this course on your own then some of the
group activities will not be relevant to you and you can skip them as
appropriate.</p>
<p>At the beginning of this course you will be taken through a typical
research driven development phase. In this phase we will create a proof
of concept code which we then build on throughout the course. This
project is extremely simple in scope as it intended to be a minimum
working example that we can use to demonstrate various development
techniques. Many of the examples in this course will refer to the
example code. If you have an existing software project we recommend that
you use that project when doing the various activities as you will
encounter more issues, learn more techniques, and the solutions to the
activities will be directly usable and beneficial to you.</p>
</section><section><h2 class="section-heading" id="assumed-knowledge-and-software-requirements">Assumed knowledge and software requirements<a class="anchor" aria-label="anchor" href="#assumed-knowledge-and-software-requirements"></a>
</h2>
<hr class="half-width">
<p>This course assumes that you have basic proficiency in python. While
python is the language that we’ll be working with primarily, most of the
lessons are applicable to any language.</p>
<p>A large part of working in a group will involve keeping track of
changes to a shared code base. For this we will be using the git version
control system, and in particular we will be using GitHub as the remote
repository.</p>
<p>Software requirements:</p>
<ul>
<li>Python 3.8 +</li>
<li>A integrated development environment (IDE) or text editor of choice
<ul>
<li>We recommend <a href="https://www.jetbrains.com/pycharm/" class="external-link">PyCharm</a> or <a href="https://code.visualstudio.com/" class="external-link">Visual Studio Code</a>
</li>
</ul>
</li>
<li>An operating system which gives you a proper command line</li>
<li>For windows this means using something like <a href="https://gitforwindows.org/" class="external-link">gitbash</a>, <a href="https://docs.microsoft.com/en-us/windows/wsl/install" class="external-link">WSL</a>, or
the <a href="https://www.anaconda.com/" class="external-link">Anaconda</a> prompt</li>
<li>For OSX or Linux the regular terminal will be fine</li>
<li>git, either from the command line, using a git desktop app, or as an
add on to PyCharm or VSCode.</li>
<li>An account on GitHub is required for some of the activities.</li>
</ul>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></section></section><section id="aio-PoC"><p>Content from <a href="PoC.html">Coding Up A Proof Of Concept</a></p>
<hr>
<p>Last updated on 2026-02-24 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/PoC.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Where/How do I start a new project?</li>
<li>How do I use a function?</li>
<li>How do I document and test my code?</li>
<li>Can I make a command line interface for my code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Build a minimal working or “proof of concept” project that we can
build on in this workshop</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="beginning-a-new-software-project">Beginning a new software project<a class="anchor" aria-label="anchor" href="#beginning-a-new-software-project"></a>
</h2>
<hr class="half-width">
<p>Before we do anything to our project we should talk about:</p>
<div class="section level3">
<h3 id="organisation">Organisation<a class="anchor" aria-label="anchor" href="#organisation"></a>
</h3>
<p>Organisation is key to a good project. Every time you start a new
project or explore a new idea it is a good idea to create a new space
for that project. This means creating a new directory for you to collect
all the relevant data, software, and documentation. You will be involved
in many projects through your career and often will have to manage
multiple projects simultaneously. It is therefore not just a good idea
to organise each project, but to have a consistent organisation
structure between projects. In this section we will make some
recommendations for organising a software project.</p>
<div class="section level4">
<h4 id="put-each-project-in-its-own-directory-which-is-named-after-the-project-">Put each project in its own directory, which is named after the
project.<a class="anchor" aria-label="anchor" href="#put-each-project-in-its-own-directory-which-is-named-after-the-project-"></a>
</h4>
<p>The location of this directory will depend on a higher level
organisation scheme. For example you may separate your projects based on
funding, based on collaboration, or based on research area.</p>
<p>Within you software project directory we recommend the following
structure:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code> .
 ├── README.md          &lt;- Description of this project
 ├── bin                &lt;- Your compiled code can be stored here (not tracked by git)
 ├── config             &lt;- Configuration files, e.g., for doxygen or for your model if needed
 ├── data
 │   ├── external       &lt;- Data from third party sources.
 │   ├── interim        &lt;- Intermediate data that has been transformed.
 │   ├── processed      &lt;- The final data sets for analysis.
 │   └── raw            &lt;- The original, immutable data dump.
 ├── docs               &lt;- Documentation, e.g., doxygen or reference papers (not tracked by git)
 ├── notebooks          &lt;- Jupyter or R notebooks
 ├── reports            &lt;- For a manuscript source, e.g., LaTeX, Markdown, etc., or any project reports
 │   └── figures        &lt;- Figures for the manuscript or reports
 └── src                &lt;- Source code for this project
     ├── external       &lt;- Any external source code, e.g., pull other git projects libraries
     └── tools          &lt;- Any helper scripts go here</code></pre>
</div>
<p>Setting up an empty structure such as the above can be done either by
making an template and then copying that every time you start a new
project. Additionally there are python packages such as
<code>cookiecutter</code> (<a href="https://pypi.org/project/cookiecutter/" class="external-link">pypi</a>, <a href="https://cookiecutter.readthedocs.io/en/1.7.2/" class="external-link">rtfd</a>, <a href="https://github.com/audreyfeldroy/cookiecutter-pypackage" class="external-link">github</a>)
that can automate this process for you, and offer a range of templates
to work with.</p>
</div>
<div class="section level4">
<h4 id="name-all-files-to-reflect-their-content-or-function-">Name all files to reflect their content or function.<a class="anchor" aria-label="anchor" href="#name-all-files-to-reflect-their-content-or-function-"></a>
</h4>
<p>It is also convenient to use a consistent and descriptive naming
format for all your files and sub-folders. For example, use names such
as <code>galaxy_count_table.csv</code>, <code>manuscript.md</code>, or
<code>light_curve_analysis.py</code>. Do not using sequential numbers
(e.g., <code>result1.csv</code>, <code>result2.csv</code>) or a location
in a final manuscript (e.g., <code>fig_3_a.png</code>), since those
numbers will almost certainly change as the project evolves (and are
meaningless on their own).</p>
</div>
</div>
<div class="section level3">
<h3 id="starting-our-project">Starting our project<a class="anchor" aria-label="anchor" href="#starting-our-project"></a>
</h3>
<p>Now we are ready to actually start doing something with our
project.</p>
<div class="section level4">
<h4 id="project-evolution">Project evolution<a class="anchor" aria-label="anchor" href="#project-evolution"></a>
</h4>
<p>In the typical project cycle for an astronomer or research software
engineer (or RSE, a formal name for people who combine professional
software expertise with an understanding of research), you will not sit
down and have a detailed discussion about what the project is, where it
needs to go, what the user stories and milestones are, and who will be
involved. Usually research evolves organically through informal
discussions with colleagues, or a sudden thought in the shower.
Similarly our software projects evolve in an organic manner, often
beginning with a small script of function to do just this one thing,
which then over time gets used, reused, augmented, shared, and thus
evolves into a software project. This evolution of ideas and code does
not fit will with much of the more formal structures that professional
software developers adhere to, and so we will not try to fit our
projects to such a scheme. Instead we will create a path for our
software that will be suited to our work style, but which draws on the
knowledge and experience of professional software developers. Thus we
will begin with a proof of concept code – a short bit of work that
proves that something works using the minimal amount of effort.</p>
</div>
<div class="section level4">
<h4 id="example-project">Example project<a class="anchor" aria-label="anchor" href="#example-project"></a>
</h4>
<p>The example project that we will work with will involve tasks that
are familiar to many astronomers. The work that is being done is mostly
for demonstration purposes – existing libraries will be able to do this
task faster and easier that we will. The point of this example project
is not the content, but the methodology that we use as we pass through
various cycles of development.</p>
</div>
</div>
</section><section><h2 class="section-heading" id="example-project-an-astronomy-catalogue-simulator">Example project: an astronomy catalogue simulator<a class="anchor" aria-label="anchor" href="#example-project-an-astronomy-catalogue-simulator"></a>
</h2>
<hr class="half-width">
<p>The example project that we will be developing will simulate a
catalogue of foreground stars in the direction of the Andromeda galaxy.
The initial requirements are as follows:</p>
<p>Stars should have randomised sky positions around the Andromeda
galaxy Positions should fall within 1 degree of the central location
Each star should have a unique ID The star ID and position should be
saved in a csv file to be analysed by other programs This program is
intended to be used by the developer and their research group which
includes people who are not proficient python programmers.</p>
<p>It is intended that the software will grow in capability and
complexity only as needed to support a current research project.</p>
<p>With this in mind we move to the first stage of our software project
– the proof of concept.</p>
<div id="solo-activity-project-structure" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="solo-activity-project-structure" class="callout-inner">
<h3 class="callout-title">SOLO Activity: Project structure</h3>
<div class="callout-content">
<p>Consider the astronomy catalogue simulator project mentioned in the
previous lesson.</p>
<p>Come up with a planned project structure that would be appropriate
for this project. How much of the structure would change if you were to
use a different language (e.g. Python vs C)? The scope of work is quite
modest and could be achieved with a flat file structure or a single
file. Which statements in the previous lesson suggest that a good
project structure will be beneficial to future work?</p>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="proof-of-concept-code">Proof of concept code<a class="anchor" aria-label="anchor" href="#proof-of-concept-code"></a>
</h2>
<hr class="half-width">
<p>The first iteration of our code is shown below. It was written in a
stream-of-conscious mode with a focus on getting a minimum working
example that proves that the work can be done.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#! /usr/bin/env python</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Demonstrate that we can simulate a catalogue of stars on the sky</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Determine Andromeda location in ra/dec degrees</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co"># from wikipedia</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>ra <span class="op">=</span> <span class="st">'00:42:44.3'</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>dec <span class="op">=</span> <span class="st">'41:16:09'</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>d, m, s <span class="op">=</span> dec.split(<span class="st">':'</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>dec <span class="op">=</span> <span class="bu">int</span>(d)<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>h, m, s <span class="op">=</span> ra.split(<span class="st">':'</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>ra <span class="op">=</span> <span class="dv">15</span><span class="op">*</span>(<span class="bu">int</span>(h)<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span>)</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>ra <span class="op">=</span> ra<span class="op">/</span>math.cos(dec<span class="op">*</span>math.pi<span class="op">/</span><span class="dv">180</span>)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co"># make 1000 stars within 1 degree of Andromeda</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>ra_offsets <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>dec_offsets <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, size<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>ras <span class="op">=</span> ra <span class="op">+</span> ra_offsets</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>decs <span class="op">=</span> dec <span class="op">+</span> dec_offsets</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co"># now write these to a csv file for use by my other program</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'catalog.csv'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"id,ra,dec"</span>, <span class="bu">file</span><span class="op">=</span>f)</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1000</span>):</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st">, </span><span class="sc">{1:7.4f}</span><span class="st">, </span><span class="sc">{2:7.4f}</span><span class="st">"</span>.<span class="bu">format</span>(i, ras[i], decs[i]), <span class="bu">file</span><span class="op">=</span>f)</span></code></pre>
</div>
<p>The above code was saved as <code>sim.py</code>. When run from the
command line it produces a file (<code>catalog.csv</code>) with a
header, one thousand rows, and columns showing the id/ra/dec of the
simulated points on the sky. Right now the code runs without error and
at first glance does what we need.</p>
<p>If we plot the ra/dec locations of the catalog we get the following
output:</p>
<figure><img src="fig/poc/catalog_plot.png" alt="catalogue plot" class="figure mx-auto d-block"><div class="figcaption">catalogue plot</div>
</figure><p>Sky plot of the catalog that comes from the sim.py program.</p>
</section><section><h2 class="section-heading" id="making-code-reusable-via-functions">Making code reusable via functions<a class="anchor" aria-label="anchor" href="#making-code-reusable-via-functions"></a>
</h2>
<hr class="half-width">
<p>Now that we have proved to ourselves that it’s possible to generate a
catalog, we want to tidy up the code a little so that it can be reused
and adapted easily.</p>
<p>At the moment our intended audience is ourselves, so we are content
with keeping all the relevant information within the code itself. As a
first step we create new variables that record the target location
(<code>ref_ra/ref_dec</code>), the number of stars to generate
(<code>nsources</code>), and how far from the central location the new
positions should be generated (<code>radius</code>). This is done using
global variables at the top of our file like this:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#! /usr/bin/env python</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co"># Demonstrate that we can simulate a catalogue of stars on the sky</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Determine Andromeda location in ra/dec degrees</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co"># configuration using global variables</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>nsources <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># from wikipedia</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>ref_ra <span class="op">=</span> <span class="st">'00:42:44.3'</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>ref_dec <span class="op">=</span> <span class="st">'41:16:09'</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>radius <span class="op">=</span> <span class="dv">1</span></span></code></pre>
</div>
<p>From here we need to make a few changes to our code so that these
variables are now used in place of the previously hard-coded values.</p>
<p>We then take all the code that is part of the position generation
stage and bundle it all together into a function which we call
<code>generate_positions</code>. This allows us to keep that part of the
code separate from the file writing stage. In fact while we are at it we
should make a function for doing the file writing. Lets call it
<code>write_file</code>. While we are writing these functions we can use
python <a href="https://www.python.org/dev/peps/pep-0257/" class="external-link">docstrings</a> to
document the intent of each function.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">def</span> generate_positions():</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">    Create `nsources` random locations within `radius` degrees of the reference `ref_ra`/`ref_dec`.</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">    ra, dec : numpy.array</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">        Arrays of ra and dec coordinates in degrees.</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    <span class="co"># convert DMS -&gt; degrees</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    d, m, s <span class="op">=</span> ref_dec.split(<span class="st">':'</span>)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    dec <span class="op">=</span> <span class="bu">int</span>(d)<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>    <span class="co"># convert HMS -&gt; degrees</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    h, m, s <span class="op">=</span> ref_ra.split(<span class="st">':'</span>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    ra <span class="op">=</span> <span class="dv">15</span><span class="op">*</span>(<span class="bu">int</span>(h)<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span>)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    ra <span class="op">=</span> ra<span class="op">/</span>math.cos(dec<span class="op">*</span>math.pi<span class="op">/</span><span class="dv">180</span>)  <span class="co"># don't forget projection effects</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>    ra_offsets <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>radius, radius, size<span class="op">=</span>nsources)</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    dec_offsets <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">1</span><span class="op">*</span>radius, radius, size<span class="op">=</span>nsources)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>    ras <span class="op">=</span> ra <span class="op">+</span> ra_offsets</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>    decs <span class="op">=</span> dec <span class="op">+</span> dec_offsets</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>    <span class="cf">return</span> ras, decs</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="kw">def</span> write_file(ras, decs):</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">    Write the ra/dec catalog to a file, and include a header and IDs.</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(<span class="st">'catalog.csv'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>        <span class="co"># creat a header row</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"id,ra,dec"</span>, <span class="bu">file</span><span class="op">=</span>f)</span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nsources):</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>            <span class="co"># use a csv format</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st">, </span><span class="sc">{1:7.4f}</span><span class="st">, </span><span class="sc">{2:7.4f}</span><span class="st">"</span>.<span class="bu">format</span>(i, ras[i], decs[i]), <span class="bu">file</span><span class="op">=</span>f)</span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>    <span class="cf">return</span></span></code></pre>
</div>
<p>Note that the first function takes no parameters, while the second is
designed to take two lists of positions as input. By breaking our code
into functional blocks we have a number of advantages:</p>
<p>We can reuse a block of code by calling the function multiple times,
and don’t have to bother with duplicated code. Duplicated code means
duplicated bugs! The code within each function will not interfere with
code in other functions, allowing us to reuse names of variables, and
for unused variables and memory to be deleted upon exiting the function.
We can document each function separately using a docstring to describe
the intent of the code. This is in addition to the inline comments that
we have used.</p>
<p>Our script can now be finished with a few more lines of code.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Do the work</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>ras, decs <span class="op">=</span> generate_positions()</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>write_file(ras, decs)</span></code></pre>
</div>
<p>As a developer the code is now separated into functional parts, so if
something goes wrong or needs changing, we know where to look to make
those changes. As a user of the code we can open the file and read the
first few lines to see what the default parameters are, and modify them
if we choose. Additionally, as a user we can read the names and
docstrings of the functions to understand what the code is doing rather
than having to read the code itself.</p>
<p>Now we have a piece of code that is easier to use. However, this code
is only really usable as is, and requires people to read/edit the source
code to understand how it works and adapt it for their use. In the next
section we’ll see how to further generalise our code by using more
function parameters, and adding a command line interface.</p>
</section><section><h2 class="section-heading" id="creating-a-command-line-interface">Creating a command line interface<a class="anchor" aria-label="anchor" href="#creating-a-command-line-interface"></a>
</h2>
<hr class="half-width">
<p>In the previous lesson we saw how we could use functions to separate
different tasks, and docstrings to describe the behaviour of these
functions. In this lesson we’ll generalise our code even further by
removing the global variables, adding functions parameters, and adding a
command line interface.</p>
<p>The first thing that we will do is remove the global variables, and
have these values passed to the functions directly. This will mean that
someone reading the code for a function doesn’t have to hunt through the
rest of the code to figure out what the global variables are.</p>
<p>For the <code>generate_positions</code> function we can use
parameters with the same name as the previously existing global
variables, and we can set their default values to match. We have also
taken the opportunity to update the docstring so that we know what types
of parameters should be passed and what they are for.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="kw">def</span> generate_positions(ref_ra<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>                       ref_dec<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>                       radius<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>                       nsources<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">    Create nsources random locations within radius of the reference position.</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">    ref_ra, ref_dec : str</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">        Reference position in "HH:MM:SS.S"/"DD:MM:SS.S" format.</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">        Default position is Andromeda galaxy.</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">    radius : float</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">        The radius within which to generate positions. Default = 1.</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">    nsources : int</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">        The number of positions to generate</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">    ra, dec : numpy.array</span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">        Arrays of ra and dec coordinates in degrees.</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>    ...</span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>    <span class="cf">return</span></span></code></pre>
</div>
<p>For the <code>write_file</code> function, we already had two
parameters that needed to be passed, but now we’ll add another which is
the output file name. This wasn’t part of the global variables, but it
was a hard coded file that we might want to change as we create multiple
catalogs. Note that this function used to use the <code>nsources</code>
global variable to know how many ra/dec values were passed. In this
revised version we just look at the length of the <code>ras</code> list
instead.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> write_file(ras, decs,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>               outfile<span class="op">=</span><span class="st">'catalog.csv'</span>):</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">    Write the ra/dec catalog to a file, and include a header and IDs.</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">    ras, decs : list, numpy.array, or any iterable</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">        Iterable of ra and dec coordinates. The length of these need to match.</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">    outfile : str</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">        Path/filename for the output file. (Overwite=True)</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(outfile, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>        <span class="co"># creat a header row</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"id,ra,dec"</span>, <span class="bu">file</span><span class="op">=</span>f)</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(ras)):</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>            <span class="co"># use a csv format</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st">, </span><span class="sc">{1:7.4f}</span><span class="st">, </span><span class="sc">{2:7.4f}</span><span class="st">"</span>.<span class="bu">format</span>(i, ras[i], decs[i]), <span class="bu">file</span><span class="op">=</span>f)</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>    <span class="cf">return</span></span></code></pre>
</div>
<p>By moving the global variables into the parameters of the functions,
and making use of the default values we don’t need to make any further
changes to our code. The following block is unchanged.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Do the work</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>ras, decs <span class="op">=</span> generate_positions()</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>write_file(ras, decs)</span></code></pre>
</div>
<p>One advantage to our changes is that we could now generate a
different catalog by adjusting these last two lines like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>ras, decs <span class="op">=</span> generate_positions(radius<span class="op">=</span><span class="fl">2.</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>write_file(ras,decs, outfile<span class="op">=</span><span class="st">'catalog_2deg.csv'</span>)</span></code></pre>
</div>
<p>We will leverage this ability in order to make a command line
interface. The recommended way to do this is to use the
<code>argparse</code> module, and an <code>if __name__</code> clause as
follows.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="co"># Set up the parser with all the options that you want</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(prog<span class="op">=</span><span class="st">'sim'</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>    group1 <span class="op">=</span> parser.add_argument_group()</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>    group1.add_argument(<span class="st">'--ref_ra'</span>, dest<span class="op">=</span><span class="st">'ref_ra'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Central/reference RA position HH:MM:SS.S format'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    group1.add_argument(<span class="st">'--ref_dec'</span>, dest<span class="op">=</span><span class="st">'ref_dec'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Central/reference Dec position DD:MM:SS.S format'</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    group1.add_argument(<span class="st">'--radius'</span>, dest<span class="op">=</span><span class="st">'radius'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">float</span>, default<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'radius within which the new positions are generated (deg)'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    group1.add_argument(<span class="st">'--n'</span>, dest<span class="op">=</span><span class="st">'nsources'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">1_000</span>,</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Number of positions to generate'</span>)</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>    group1.add_argument(<span class="st">'--out'</span>, dest<span class="op">=</span><span class="st">'outfile'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'catalog.csv'</span>,</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Filename for saving output (csv format)'</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>    <span class="co"># parse the command line input</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>    options <span class="op">=</span> parser.parse_args()</span></code></pre>
</div>
<p>Here we have created a single group of arguments called
<code>group1</code>, and then we add five different arguments to that
group. Note that we provide both a call signature (<code>--out</code>)
for specifying a parameter, as well as the name/type/default value of
that parameter (<code>dest/type/default</code>). The <code>help</code>
is optional but highly recommended. If we were to run the code above
with the <code>--help</code> option then we would get the following
output:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$&gt; python sim.py --help
usage: sim [-h] [--ref_ra REF_RA] [--ref_dec REF_DEC] [--radius RADIUS] [--n NSOURCES] [--out OUTFILE]

optional arguments:
  -h, --help         show this help message and exit

  --ref_ra REF_RA    Central/reference RA position HH:MM:SS.S format
  --ref_dec REF_DEC  Central/reference Dec position DD:MM:SS.S format
  --radius RADIUS    radius within which the new positions are generated (deg)
  --n NSOURCES       Number of positions to generate
  --out OUTFILE      Filename for saving output (csv format)</code></pre>
</div>
<p>Right away we have a way for people to understand how to use the
program without having to open the source code. This will include you,
two days from now, when you forgot some of the details of the code.</p>
<p>Finally, we can connect the user input to the program by using the
<code>options</code> object. Each of the parameters that were read in
with a <code>dest=thing</code> can be accessed using
<code>options.thing</code>. If we specified a type then argparse will
make sure that users don’t give input that can’t be converted to that
type. The final part of our code now looks like this:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>    <span class="co"># parse the command line input</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>    options <span class="op">=</span> parser.parse_args()</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>    ras, decs <span class="op">=</span> generate_positions(ref_ra<span class="op">=</span>options.ref_ra,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>                                   ref_dec<span class="op">=</span>options.ref_dec,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                                   radius<span class="op">=</span>options.radius,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>                                   nsources<span class="op">=</span>options.nsources)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    write_file(ras, decs, outfile<span class="op">=</span>options.outfile)</span></code></pre>
</div>
<p>Since we specified default values for all of the inputs, we can run
<code>python sim.py</code> and it will run with the default values.</p>
</section><section><h2 class="section-heading" id="creating-a-simple-testing-script">Creating a simple testing script<a class="anchor" aria-label="anchor" href="#creating-a-simple-testing-script"></a>
</h2>
<hr class="half-width">
<p>We now have a script with a command line interface that allows people
to use the code without having to read the source. At this point we are
feeling rather professional and are happy to share the code with others.
One of the things that is often scary is the thought of others finding
bugs in our code and then having to fix these bugs. A good way to
alleviate these fears is to do some testing of the code ourselves to
catch all the obvious errors before the script is sent to others. In a
later lesson we’ll go through some more formal and rigorous testing, but
for now we are going to start simple with some of the most basic
tests.</p>
<p>In our file <code>test_sim.sh</code> we will make three tests. The
first two tests we are going to do will just ensure that the code will
not immediately crash when we run it:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#! /usr/bin/env bash</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"Testing sim.py"</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="ex">python</span> sim.py <span class="kw">||</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="st">"FAILED to run with default parameters"</span><span class="kw">;</span> <span class="bu">exit</span> 1 <span class="kw">;}</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="ex">python</span> sim.py <span class="at">--help</span> <span class="kw">||</span> <span class="kw">{</span> <span class="bu">echo</span> <span class="st">"FAILED to print help"</span><span class="kw">;</span> <span class="bu">exit</span> 1 <span class="kw">;}</span></span></code></pre>
</div>
<p>The next test we do will ensure that when we pass a filename to the
<code>--out</code> option, we will get a new file with that name. We use
the bash <code>[ ] test</code> and <code>-f conditional</code> to see
that the file exists.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="ex">python</span> sim.py <span class="at">--out</span> test.csv</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">!</span> <span class="ot">-f</span> <span class="st">"test.csv"</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    <span class="bu">echo</span> <span class="st">"FAILED to generate ouput test.csv"</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    <span class="bu">exit</span> 1</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="bu">echo</span> <span class="st">"all tests PASSED"</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="bu">exit</span> 0</span></code></pre>
</div>
<p>The last two lines above then make sure that when the tests all pass
we get a positive message and return an <a href="https://www.gnu.org/software/bash/manual/html_node/Exit-Status.html" class="external-link">exit
status</a> of 0.</p>
<p>We now have a test script that will catch the most egregious issues
with our script. Any time we make changes to our script we should run
the test script just to make sure that we haven’t seriously broken
anything.</p>
<p>More advanced testing with bash is not explored here as we will move
to a python based test environment in a later lesson. The python based
testing will make it easier to do things like make sure the right number
of entries exist in the catalogue file and that the positions all lie
within the specified region.</p>
</section><section><h2 class="section-heading" id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<hr class="half-width">
<p>In this first development cycle we have:</p>
<ul>
<li>Demonstrated that we can simulate a catalogue of positions on the
sky;</li>
<li>Written a function to do the simulation, and another to write the
results to a file;</li>
<li>Created a command line interface to make the script easy to use and
re-use; and</li>
<li>Made a simple test script to alert us when our changes break the
code.</li>
</ul>
<p>If you would like to see the status of the project at the end of this
cycle you can look at the cycle1 branch on GitHub (<a href="https://github.com/ADACS-Australia/MAP21B-Training-BPindor/tree/cycle1" class="external-link">at
this link</a>). <!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></p>
</section></section><section id="aio-DevInATeam"><p>Content from <a href="DevInATeam.html">Developing Software In A Team</a></p>
<hr>
<p>Last updated on 2026-02-27 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/DevInATeam.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are some pro/con of developing in a team?</li>
<li>What are some common team roles?</li>
<li>How can GitHub help managing tasks in a group project?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Gain experience developing software in a team environment</li>
<li>Understand some common project management styles</li>
<li>Create a new GitHub repo and push our project</li>
<li>Experience a full development cycle with our test project</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="benefits-and-pit-falls">Benefits and pit-falls<a class="anchor" aria-label="anchor" href="#benefits-and-pit-falls"></a>
</h2>
<hr class="half-width">
<p>Working on a software project as part of a team is a very different
experience from working on a solo project. There are of course great
advantages to having multiple people working on a problem, but there are
also some pit-falls that need to be avoided, and overheads that cannot
be avoided.</p>
<div class="section level3">
<h3 id="benefits-of-working-in-a-team">Benefits of working in a team<a class="anchor" aria-label="anchor" href="#benefits-of-working-in-a-team"></a>
</h3>
<ul>
<li>Each person has different areas of expertise</li>
<li>More person-hours available</li>
<li>Group discussion leads to better decision making</li>
<li>Group members can learn from each other faster than they can learn
from a book/website</li>
<li>Seeing how others work and solve problems can help you learn new
skills that you didn’t know you needed</li>
<li>Bug-fixing is easier when you have an informed buddy to talk to</li>
<li>Work can be assigned to people with the most relevant skills
increasing efficiency</li>
<li>Dividing the development and testing of a work item between two
people can make for better code and more complete tests</li>
</ul>
</div>
<div class="section level3">
<h3 id="pit-falls-to-avoid">Pit-falls to avoid<a class="anchor" aria-label="anchor" href="#pit-falls-to-avoid"></a>
</h3>
<ul>
<li>Siloing work:
<ul>
<li>Separating work items can be a good idea but there needs to be
frequent check-ins to ensure that the software being developed by two
people is not diverging or conflicting</li>
</ul>
</li>
<li>Inconsistent standards:
<ul>
<li>Even though people may have personal preferences or styles,
documentation, commenting, and testing should be consistent across a
code base.</li>
</ul>
</li>
<li>Non-constructive criticism:
<ul>
<li>When things work they just work and no one talks about it</li>
<li>When things break everyone talks about it</li>
<li>Given that issues result from negative experiences, it is important
for team moral to always try and keep feedback as constructive as
possible</li>
</ul>
</li>
<li>Platform / dependency conflicts:
<ul>
<li>There is no guarantee that all developers will be using the same
operating system or development tools.</li>
<li>Allowing people the freedom to choose is important but the
differences need to be managed via an agreement on how/when/where
testing takes place, what acceptance looks like, and the use of a style
guide.</li>
<li>Having some files with windows style end of line and others with
linux style end of line can make it tedious to track changes</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="overheads-that-cannot-should-not-be-avoided">Overheads that cannot (should not) be avoided<a class="anchor" aria-label="anchor" href="#overheads-that-cannot-should-not-be-avoided"></a>
</h3>
<p>Project management will take time, and may not be a skill that you
have. Invest time in training. Communication and coordination take time
but are vital to success Commit conflicts will arise even if everything
is done right, these need to be discussed and handled properly rather
than ignored The moral of the team is important to success and will take
time and effort to maintain, but it is worth doing so that your project
can see the benefits listed above.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>Working in a team can be a hugely beneficial experience for all
involved, however there are some negative features that need to be
avoided or managed. In the next section we’ll explore how we can create
and document project standards that will make working in a team much
easier.</p>
</div>
</section><section><h2 class="section-heading" id="communication-and-project-management">Communication and project management<a class="anchor" aria-label="anchor" href="#communication-and-project-management"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="communication">Communication<a class="anchor" aria-label="anchor" href="#communication"></a>
</h3>
<p>Team work requires effective communication between team members. This
helps to keep everyone up to date on the status of the project, the
current and future direction of the work, and avoids duplication of
effort. Email, slack, messenger, GitHub issues, chats over a coffee, or
a formal weekly meeting, are all valid ways of keeping the teem
together. A formal meeting once a month complimented by a weekly email
to status check, and real time slack messaging for immediate questions
may be a good solution for a 5 person team working on a year long
project. An informal weekly chat over lunch with intermittent emails may
be good for a 2 person team working on a project that lasts a few
months. The most important thing is that the chosen method is effective
and that it includes all team members.</p>
<p>If an informal or ephemeral communication medium is involved when
coming to an agreement or making a decision, it is good practice to have
a follow up communication to reiterate the decision and reasoning using
a medium that can be archived. For example, if the team meets over a
coffee, discusses a current issue, and decides on a way forward, it is a
good idea for someone to follow this up with an email so that the
details of the decision are not lost.</p>
</div>
<div class="section level3">
<h3 id="project-management-styles">Project management styles<a class="anchor" aria-label="anchor" href="#project-management-styles"></a>
</h3>
<p>The two main project management styles that are applied to software
development are <strong>waterfall</strong> and <strong>agile</strong>.
Neither of these are a project management methodology but are more like
umbrella terms that group a set of methodologies that share a common
mindset. In the waterfall mindset there is a very linear approach to the
design and execution and delivery of the project with the main focus
being on the process. In the agile mindset the main focus is on outcomes
and deliverables, with the design and execution and delivery occurring
in cycles.</p>
<div class="section level4">
<h4 id="waterfall">Waterfall<a class="anchor" aria-label="anchor" href="#waterfall"></a>
</h4>
<p>In a waterfall project the whole life cycle of a project is mapped
onto distinct, sequential work items, with each item relying on those
that occur before, and blocking those that come after. Waterfall project
management therefore represents a very rigid and linear approach. The
waterfall system is a very traditional method for managing a project
with participants being assigned clear roles and expectations.</p>
<p><img src="fig/team/waterfall.png" alt="Waterfall Methodology" class="figure">
Image credit: <a href="https://startinfinity.com/project-management-methodologies/waterfall" class="external-link uri">https://startinfinity.com/project-management-methodologies/waterfall</a></p>
<p>The name waterfall comes from the fact that each work item will
cascade onto the next. In a waterfall project there is a lot of
attention paid to defining the entirety of the project up front, and
then a close adherence to the project plan and timeline. It is therefore
difficult to incorporate changes into the project plan, and therefore it
is hard to respond to setbacks, opportunities, or changes in
requirements.</p>
<p>The waterfall project management style was initially designed in the
1970’s for use in software development projects. It was taken on by many
other industries to great success, but is now seen as an outdated
methodology for software projects.</p>
</div>
<div class="section level4">
<h4 id="agile">Agile<a class="anchor" aria-label="anchor" href="#agile"></a>
</h4>
<p>In 2001 the Manifesto for Agile Software Development was published.
The agile manifesto can be summed up as:</p>
<blockquote>
<p>We are uncovering better ways of developing software by doing it and
helping others do it. Through this work we have come to value:</p>
<p>Individuals and interactions over processes and tools Working
software over comprehensive documentation Customer collaboration over
contract negotiation Responding to change over following a plan</p>
<p>That is, while there is value in the items on the right, we value the
items on the left more.</p>
<p><a href="https://agilemanifesto.org/" class="external-link uri">https://agilemanifesto.org/</a></p>
</blockquote>
<p>The agile manifesto is based on the following principles:</p>
<ol style="list-style-type: decimal">
<li>The highest priority is to satisfy the customer through early and
continuous delivery of valuable software.</li>
<li>Welcome changing requirements, even late in development. Agile
processes harness change for the customer’s competitive advantage.</li>
<li>Deliver working software frequently, from a couple of weeks to a
couple of months, with a preference to the shorter timescale.</li>
<li>Business people and developers must work together daily throughout
the project.</li>
<li>Build projects around motivated individuals. Give them the
environment and support they need, and trust them to get the job
done.</li>
<li>The most efficient and effective method of conveying information to
and within a development team is face-to-face conversation.</li>
<li>Working software is the primary measure of progress.</li>
<li>Agile processes promote sustainable development. The sponsors,
developers, and users should be able to maintain a constant pace
indefinitely.</li>
<li>Continuous attention to technical excellence and good design
enhances agility.</li>
<li>Simplicity–the art of maximising the amount of work not done–is
essential.</li>
<li>The best architectures, requirements, and designs emerge from
self-organising teams.</li>
<li>At regular intervals, the team reflects on how to become more
effective, then tunes and adjusts its behaviour accordingly.</li>
<li>The agile mentality is designed to be able to be flexible, respond
to change, deliver a working product early and have it improve
incrementally over time.</li>
</ol>
<p>Advantages of the agile mentality include:</p>
<ul>
<li>faster deployment of working solutions</li>
<li>better quality of work</li>
<li>increased client satisfaction</li>
<li>reduced risk thanks to frequent testing and deployment</li>
<li>increased team moral</li>
<li>a project that finishes early is still able to deliver a working
result</li>
</ul>
<p>Some potential drawbacks include:</p>
<ul>
<li>potential for scope creep from continuous client feedback</li>
<li>workload management can be difficult when duties and requirements
are not known far in advance</li>
<li>short development cycles can mean that skills gaps are not
identified early leading to delays in delivery</li>
</ul>
<p>You will likely see that the Agile development mentality fits much
better with research project management including both traditional
research work and software development projects. Additionally you may
note that your organisation may employ a mix of different management
methodologies for different projects, or at different levels of the
organisation. Understanding the benefits and drawbacks of each will help
you choose a project management style that works best for your
project.</p>
</div>
</div>
<div class="section level3">
<h3 id="popular-agile-methodologies">Popular Agile methodologies<a class="anchor" aria-label="anchor" href="#popular-agile-methodologies"></a>
</h3>
<div class="section level4">
<h4 id="scrum">Scrum<a class="anchor" aria-label="anchor" href="#scrum"></a>
</h4>
<p>Scrum is mainly focused on the idea of sprints. Sprints are where the
bulk of the “work” gets done, although there is a significant amount of
effort put into the preparation and planning of each sprint, and then
the post-sprint review and retrospective. Sprints are typically 1-2
weeks in duration and will focus on a particular set of goals. During a
sprint there is usually a daily scrum at the start of the day in which
people talk about what they did the day before, what their plans are for
today, and what problems they might foresee. The sprint review is about
reviewing the work that was completed, reporting related to said work,
and identification of incomplete work. The retrospective is a more
meta-level reflection on how the sprint went, meant to identify how the
team worked together, what organisation or communication worked well or
not, and what changes could be made to make the next sprint more
productive.</p>
<p><img src="fig/team/scrum.webp" alt="scrum" class="figure"> Image credit: <a href="https://jordanjob.me/blog/scrum-diagram/" class="external-link uri">https://jordanjob.me/blog/scrum-diagram/</a></p>
<p>The scrum methodology is based on team work and has well defined
roles. The benefits of scrum include the ability to react to changes in
requirements or resourcing, continuous testing/integration is
effectively built in, prioritisation of tasks can be adjusted throughout
the process. The disadvantages of scrum are that you need very good
organisation before each sprint to maximise productivity. Additionally
it requires that team members are able to block out a 1-2 week period in
which they focus solely on the sprint and maintain a high focus.
Clearly, scrum requires a medium to large team (5+) in order to be
effective.</p>
</div>
<div class="section level4">
<h4 id="kanban">Kanban<a class="anchor" aria-label="anchor" href="#kanban"></a>
</h4>
<p>In the Kanban methodology the main focus is on the visualisation that
is used during the development process – the Kanban board. One goal of
the board is to identify potential bottlenecks in the process. An
example board is shown below with the following features:</p>
<p><strong>Tasks</strong> that are represented as squares. Sticky notes
or cards are often used on a physical wall, or their digital
representation online.</p>
<p><strong>Columns</strong> that represent the state of each task. A
task is expected to migrate from the left most column (Ready/Backlog)
through the central columns and into the final (Done/Complete) column,
as the related work is being done.</p>
<p><strong>Work in progress limits</strong>. In order to maintain focus
and productivity, there are often limits on the number of cards that can
be placed into some of the columns. In particular the “in progress” and
“testing” columns are limited by the available people time allocated to
the project.</p>
<p><strong>Swim lanes</strong> (not shown), are rows that separate tasks
based on categories of work such as documentation, testing, or
reporting. Alternatively, colour coding of cards can be used to identify
these categories.</p>
<p><img src="fig/team/kanban.png" alt="Kanban Methodology" class="figure"> Image
credit: <a href="https://startinfinity.com/project-management-methodologies/kanban" class="external-link uri">https://startinfinity.com/project-management-methodologies/kanban</a></p>
<p>Even when the Kanban methodology is not being explicitly used, the
visualisation process is so powerful that it often used in many other
project management strategies. It’s not uncommon to see a Kanban board
on the wall during a two week sprint.</p>
<p>The advantage of Kanban is that you have a single place to track the
progress of all the tasks, and bottle necks can be quickly identified.
One of the main disadvantages of Kanban come from people failing to
update the Kanban board as a task is being worked on (poor
communication), or updating too often (high overhead). Many project
management software tools incorporate a Kanban board and tools like JIRA
even have a way of migrating and updating tasks based on activity in a
linked GitHub repository so that people can keep the Kanban up to date
without having to visit the board itself.</p>
</div>
</div>
<div class="section level3">
<h3 id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h3>
<p>Communication and effective project management are critical to the
success of any collaborative project. There is no one-size-fits-all
solution, and you will need to consider the project requirements, and
the size and expertise of your team when deciding on a communication and
management strategy. Thankfully there are many project management tools
online that are free that will support whatever choice you make.</p>
</div>
</section><section><h2 class="section-heading" id="member-roles">Member roles<a class="anchor" aria-label="anchor" href="#member-roles"></a>
</h2>
<hr class="half-width">
<p>Depending on the scope of your project, the size of the team, and the
management strategy that is being used, you will have a number of roles
that need to be filled within the team. Below is a list of some common
roles that may be applicable to your project along with a short
description. It should be noted that not all roles are required for all
projects, and that the roles do not need to map to people on a 1:1
basis. It is normal to have multiple people per role and to have some
people acting in multiple roles. The most important thing is that you
consider the different roles and responsibilities, and have at least an
implicit agreement on who is going to be filling each of the roles. This
will help people to understand their responsibilities and who they
should be handing work over to or working with during the project
development.</p>
<div class="section level3">
<h3 id="roles">Roles<a class="anchor" aria-label="anchor" href="#roles"></a>
</h3>
<ul>
<li>Software Developer
<ul>
<li>Primarily focused on writing the software, fixing bugs, implementing
new features.</li>
<li>Should be responsive to issues, and provide implementation advice to
the team.</li>
<li>Documentation and Test Developer</li>
<li>Primarily focused on the creation of documentation and developing
tests.</li>
<li>Test cases and docstrings should be consistent.</li>
<li>Typically also will be responsible for automating the testing
process and reporting issues.</li>
<li>Documentation can be focused on docstrings but can also include
online documentation, help files, tutorials, and examples.</li>
</ul>
</li>
<li>Product Owner
<ul>
<li>The person who takes responsibility for setting the software project
goals.</li>
<li>This person is tasked with understanding the client/user needs and
translating them into user stories, milestones, and tasks.</li>
</ul>
</li>
<li>Domain Expert
<ul>
<li>Someone who has a good understanding of the context in which the
software will be deployed or used.</li>
<li>When developing software for astronomers, it is not essential for
all the development team to have a good understanding of the general or
specific field of application.</li>
<li>A domain expert can be an internal point of contact for the
development team when they have questions about the correctness or
utility of an aspect of theproject.</li>
</ul>
</li>
<li>Project Manager
<ul>
<li>Primarily focused on the organisation of the team, ensuring that
team members have tasks matched to their skills, and that the required
skills are available within the team.</li>
<li>The project manager will be responsible for the timing and
scheduling of work and deadlines.</li>
</ul>
</li>
<li>Reviewer
<ul>
<li>Any piece of work that is completed should be assigned to a reviewer
to ensure that the work is up to standard.</li>
<li>The reviewer should have a good understanding of the goals of a
piece of work and be able to give feedback on areas that need
improvement.</li>
<li>The reviewer should ideally not be involved in the development of
the piece of work they are reviewing.</li>
</ul>
</li>
<li>Approver
<ul>
<li>Similar to a reviewer, except that there is no requirement for an
approver to understand the implementation of the work being done.</li>
<li>An approver is focused on ensuring that the proper procedures have
been followed.</li>
</ul>
</li>
<li>User Acceptance Tester
<ul>
<li>Someone who is able to perform the necessary tests to ensure that
each of the user stories have been met.</li>
<li>Acceptance testing is typically not able to be automated and will
require manual interaction to ensure that the end user can perform the
tasks outline in the user stories.</li>
</ul>
</li>
</ul>
<p>The following workflow describes the interaction of the above roles
within a generic software project:</p>
<figure><img src="fig/team/workflow.png" alt="Project workflow with roles" class="figure mx-auto d-block"><div class="figcaption">Project workflow with roles</div>
</figure><p>Solid lines indicate the flow of content for action, approval, or
feedback. Dashed lines indicate input in the form of advice or
oversight.</p>
<div id="group-activity-who-does-what-and-when" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="group-activity-who-does-what-and-when" class="callout-inner">
<h3 class="callout-title">GROUP Activity: Who does what and when?</h3>
<div class="callout-content">
<p>Within your software project group review the past three lessons and
discuss the following:</p>
<ul>
<li>What software development roles are required for your project?</li>
<li>What project management roles are required for your project?</li>
<li>Are there any roles that would be beneficial to your project that
are not listed?</li>
<li>How are these roles distributed among the team?</li>
<li>Are there people with multiple roles or roles shared among multiple
people?</li>
<li>Who determines the timeline and deliverables for this project?</li>
<li>Is the timeline flexible?</li>
<li>Can you classify the deliverables as one of
required/desired/optional?</li>
<li>How often and in what format should communication be managed?</li>
</ul>
<p><em>If</em> you have been involved in a previous software development
project, please share the following with your teammates:</p>
<ul>
<li>What practices worked well and could be brought into this and future
projects?</li>
<li>What practices didn’t work well and should be avoided in the
future?</li>
<li>Was the previous project larger or smaller than the current one and
how would that affect your choice of management/communication?</li>
</ul>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="create-project-standards-and-expectations">Create project standards and expectations<a class="anchor" aria-label="anchor" href="#create-project-standards-and-expectations"></a>
</h2>
<hr class="half-width">
<p>When a single person is working on a project there will typically be
a consistency imposed simply by the fact that the developer has ‘their
way’ of doing things (though this consistency may not exist through
time). When multiple developers are working on a project it is good
practice to have an agreed up on set of standards that will be followed
to ensure that the project has a consistent style and that common
practices are followed. These practices can include how/when to test,
the branch/develop/merge cycle, documentation formats, as well as code
style. A common place to note these standards and expectations is in the
<code>CONTRIBUTING.md</code> file in the root of your software project.
This file should be considered to be supplementary to the
<code>README.md</code> file, and for a slightly different audience.
Whilst the README.md file is aimed at users of the software, the
<code>CONTRIBUTING.md</code> file is aimed at people who might develop
the software, give feedback, or submit bug/feature requests.</p>
<div class="section level3">
<h3 id="sections-to-consider-for-contributing-md">Sections to consider for <code>CONTRIBUTING.md</code>
<a class="anchor" aria-label="anchor" href="#sections-to-consider-for-contributing-md"></a>
</h3>
<ul>
<li>Welcome and encourage people to contribute to the project</li>
<li>Table of Contents (especially if the file is long)</li>
<li>Style guide
<ul>
<li>List standards for code style</li>
<li>Consider using a linter and listing it here (with settings)</li>
<li>Note the docstring format and guidelines</li>
</ul>
</li>
<li>Testing
<ul>
<li>Where the tests are located</li>
<li>How the test are run</li>
<li>The machine/environment on which the tests are expected to pass</li>
</ul>
</li>
<li>How to submit changes</li>
<li>Who can submit changes</li>
<li>Expectations for what changes will be accepted</li>
<li>The pull request approval process</li>
<li>How to report a bug
<ul>
<li>What is expected for a good bug report</li>
<li>What tags/categories should be used when submitting a report</li>
<li>How to request an “enhancement”</li>
<li>What enhancements are likely to be support and which are not</li>
</ul>
</li>
<li>Templates</li>
<li>Examples for enhancement / bug report / change requests.</li>
<li>Code of Conduct
<ul>
<li>Expectations for behaviour when contributing to the project</li>
<li>Consequences for breaching the code of conduct</li>
</ul>
</li>
<li>Email/web address for reporting breaches</li>
<li>Recognition model
<ul>
<li>Let people know how their contributions will be recognised.</li>
<li>The following may be appropriate:
<ul>
<li>An acknowledgement section on the wiki</li>
<li>Co-authorship or acknowledgements in a published paper</li>
<li>Invitation to join as github contributor</li>
<li>A shout out on social media</li>
<li>A beverage of choice</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The <code>CONTRIBUTING.md</code> file can become quite long if all of
the above are included. The key is to have a record of how people should
interact with others and with the project and that the project
maintainers adhere to these guide lines.</p>
</div>
</section><section><h2 class="section-heading" id="creating-a-github-repository">Creating a GitHub repository<a class="anchor" aria-label="anchor" href="#creating-a-github-repository"></a>
</h2>
<hr class="half-width">
<p>At the moment we have a bunch of code, documentation, and associated
files. We wish to make these available to others in the easiest way
possible. We could just zip them all up and email to collaborators.
However this means that collaborators no longer benefit from any future
development that you do, and even worse, will start asking questions
about code that may have diverged from the version you are working on. A
solution to this problem is to keep all your code under <a href="https://swcarpentry.github.io/git-novice/" class="external-link">version control</a>,
and to make use of one of the many free, online repositories to host a
copy of the code. For this lesson we’ll focus on <a href="https://github.com/" class="external-link">GitHub</a>, but <a href="https://gitlab.com/" class="external-link">gitlab</a> and <a href="https://bitbucket.org/" class="external-link">bitbucket</a> are also good
alternatives.</p>
<div class="section level4">
<h4 id="create-an-account-on-github">Create an account on Github<a class="anchor" aria-label="anchor" href="#create-an-account-on-github"></a>
</h4>
<p>Github accounts are free, you just need an email address to sign up.
Since some academic institutions shut off your email address promptly
when your contract ends, it may be a good idea to use a
non-institutional or personal email to sign up to github or other
services that will outlast your current contract.</p>
</div>
<div class="section level4">
<h4 id="create-a-new-repository-on-github">Create a new repository on Github<a class="anchor" aria-label="anchor" href="#create-a-new-repository-on-github"></a>
</h4>
<p>Go to Github and sign in. You should be taken to a page which has a
listing of your repositories and a green button to create a new one.
Click the button and you should see a screen similar to the
following.</p>
<figure><img src="fig/team/github_create_repo.png" alt="Create a github repo" class="figure mx-auto d-block"><div class="figcaption">Create a github repo</div>
</figure><p>For now, lets create a truly empty repository so don’t select any of
the last three boxes. Just give the repo a name (your project name is a
good choice if available). You can change the description later or fill
it in now.</p>
<p>Once you create the repository you’ll see a set of instructions about
what to do next.</p>
<figure><img src="fig/team/github_empty_repo.png" alt="Empty github repo" class="figure mx-auto d-block"><div class="figcaption">Empty github repo</div>
</figure><p>Now we are going to go with “create a new repository from the command
line”.</p>
<p>The first part is to make a new local git repository using init / add
/ commit and to name the branch to be main (<a href="https://sfconservancy.org/news/2020/jun/23/gitbranchname/" class="external-link">instead
of master</a>).</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">git</span> init</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">git</span> add README.md</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">git</span> add requirements.txt encironment.yml</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">git</span> add sim_catalog skysim/<span class="pp">*</span>.py</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"first commit"</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">git</span> branch <span class="at">-M</span> main</span></code></pre>
</div>
<p>The next step is to link your local repository with the one that you
just created on Github. Replace <code>PaulHancock/sky_sim.git</code>
with your username and the name of the repo that you chose.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">git</span> remote add origin git@github.com:PaulHancock/sky_sim.git</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">git</span> push <span class="at">-u</span> origin main</span></code></pre>
</div>
<p>After you have done the <code>git push</code> you’ll have added all
your local changes to the remote repository and you can view the new
state of the project on Github. Note how your <code>README.md</code>
file gets rendered into a nice splash page.</p>
<p>When you push to <code>origin main</code> you’ll have to authenticate
with Github, see the <a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh" class="external-link">github
documentation</a> for instructions on how to set that up for ssh.</p>
<p>If you set your repository to be public then anyone on the internet
can see and download your code, they can make a fork (copy) of it to
work on themselves, and can even send feature requests or bug reports
via the issue tracker. We will get into those features later, but for
now all you need to do is let your collaborators know that your code is
available on Github, send them the link, and then they can
download/clone it as needed. An added bonus is that as you make changes
to your code, and then <code>add/commit/push</code> these changes, your
collaborators can then pull those changes and get the updates without
having to bug you about it.</p>
</div>
</section><section><h2 class="section-heading" id="issue-tracking-on-github">Issue tracking on GitHub<a class="anchor" aria-label="anchor" href="#issue-tracking-on-github"></a>
</h2>
<hr class="half-width">
<p>Once your code is in the wild hopefully people will find it, use it,
and give feedback. Positive feedback in person or by email is always
nice, however there is also the issue of bugs, new feature requests, and
people wanting clarification. Dealing with these last three points
requires some organisation, and so we will learn how to use an issue
tracker for this.</p>
<p>Github, gitlab, and bitbucket all offer an form of issue tracking
that is attached to each of your software repositories. In this lesson
we’ll focus on the Github issue tracker, but the lessons learned here
are applicable to any issue tracker system.</p>
<p>The issue tracker is a way of engaging with your co-developers and
end-users to discuss any problems that people may be having when using
the software. The issue tracker is available for all Github
repositories, and enabled by default. However, publishing code on Github
does not mean that you are obligated to provide any support at all. If
you don’t intend on providing support for your software, it would be a
good idea to mention this in the <code>README.md</code> file that is
shown on the landing page so that people have clear expectations. If you
do intend to provide support and receive feedback then the issue tracker
is for you.</p>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>We will cover four of the most common issues that you are likely to
see or use on the issue tracker, and give some guidance and advice about
how to approach them. We’ll cover general questions, bug reports,
feature requests, and pull requests.</p>
<p>Github issues has become a full featured work planning and project
management system (see link), most of which is beyond the scope of this
course. We will be focusing on the basic capabilities of the issue
tracker to get you and your group started. Once you are up and running
you should explore the other features.</p>
<p>To begin, let’s navigate to the github repository for our project of
choice. On the front page you should see a set of tabs. By default
you’ll be seeing the <code>&lt;&gt; code</code> tab, but we want to
select the <code>⊙ Issues</code> tab.</p>
<figure><img src="fig/team/repo-tabs-issues.png" alt="Repo with no issues" class="figure mx-auto d-block"><div class="figcaption">Repo with no issues</div>
</figure><p>Initially this will be blank for your project because there are no
issues (yay).</p>
</div>
<div class="section level3">
<h3 id="creating-an-issue">Creating an issue<a class="anchor" aria-label="anchor" href="#creating-an-issue"></a>
</h3>
<p>Navigate to the <code>Issues</code> tab of a repository on Github and
you’ll see a “New issue” button in green. Press this and we’ll explore
some of the options.</p>
<p>An issue has a title (or short description) and a comment (long
description). When creating an issue you can add some labels to it so
that others can easily understand what kind of issue you are reporting.
Github has a range of built in labels, and the repository owner/admins
can create more if needed.</p>
<figure><img src="fig/team/issue-labels.png" alt="Label and issue" class="figure mx-auto d-block"><div class="figcaption">Label and issue</div>
</figure><p>Once an issue has been created, the author or repository owner/admins
can adjust the issue by assigning people to work on it, updating the
labels. This is a helpful piece of organisational work. Others can can
also comment on the issue so that there is a back and forth between the
developers, the person reporting the issue, and anyone else experiencing
the same/similar issues. When an issue is resolved it can be marked as
closed. Closed issues are not shown by default, but can be seen by
removing the <code>is:open</code> or add the <code>is:closed</code>
filter.</p>
<p>We will now go through some of the different types of issues that are
typically reported and in the next lesson we’ll have a go at
creating/resolving these issues.</p>
<div class="section level4">
<h4 id="questions">Questions<a class="anchor" aria-label="anchor" href="#questions"></a>
</h4>
<p>This tag is usually used by people asking for clarification. There is
not necessarily any issue with the code, it is just that the user
doesn’t understand something. The threaded structure of the issue
tracker makes this a useful place to have a discussion about the
question. Questions usually lead to additional documentation being
created – for example an FAQ section on the wiki for the repository.
Questions can also be escalated into bugs or feature requests.</p>
<p>If someone sends you a question via email that does not involve
personal/private information, then it is often a good idea to ask them
to post the question on the issue tracker and then discuss it there. If
the person isn’t that interested in using Github then I often just ask
for their permission to replicate the email discussion on the issue
tracker (with/without naming them depending on their preference). The
mentality is the same with people asking questions in a classroom – if
one person has a question, often there are others with the same question
who are too shy to ask. By answering the question publicly you reduce
the number of duplicate email chains that you have.</p>
</div>
<div class="section level4">
<h4 id="bug-reports">Bug reports<a class="anchor" aria-label="anchor" href="#bug-reports"></a>
</h4>
<p>Bug reports are for when people find an error in your code. The
common errors are code crashing, or code giving unexpected or wrong
output. Best practice for reporting a bug is to give as much information
as is required to reproduce the error. This is the minimum working
example (MWE), or rather the minimum example that produces the error. It
is at this point where code versions and environments can be super
helpful. Asking people to run <code>mycode --version</code> and paste
the output in the bug report can help a lot. Sometimes people work with
old versions of code and simply updating to a new version can fix the
issue. For a program crash, a copy/paste of the output/error is
useful.</p>
<p>Github allows you to add files and images to the issue tracker so
that people have the option of supplying a small amount of real data to
reproduce the error. Similarly they can screenshot a problem
(particularly useful for graphic interfaces or code that produces
plots).</p>
<p>Keep in mind that when someone posts a bug report it is because they
are having a problem. That problem is real. It may not be due to your
code. It may be due to them misusing or misunderstanding your code. It
may be due to issues with code that you are dependent on. It may be your
fault. Just remember that people are not looking to place blame, but are
looking to find a solution. Have a conversation with them in the issue
tracker to figure out what is going on and how you could help solve the
problem. If you don’t consider the bug to be a problem (it’s a feature
not a bug) then note this in the issue tracker.</p>
</div>
<div class="section level4">
<h4 id="feature-requests">Feature requests<a class="anchor" aria-label="anchor" href="#feature-requests"></a>
</h4>
<p>Sometimes a user will have an idea about how to improve or expand the
capability of the software they are using. A feature request is a way
for the user to suggest these improvements. Feature requests are not an
indication that something is wrong, but that there is an opportunity to
be better. Some example feature requests are:</p>
<ul>
<li>support additional input/output formats, or</li>
<li>support additional operating systems, or</li>
<li>provide some sanity checking before users made silly mistakes,
or</li>
<li>improve a users quality of life by combining multiple often used
functions into one, or</li>
<li>provide documentation in an alternative format (html, pdf, online
wiki etc).</li>
</ul>
<p>Feature requests are typically a user’s wish list, which if
fulfilled, will save the user time or allow them to expand the scope of
their work.</p>
</div>
<div class="section level4">
<h4 id="pull-requests">Pull requests<a class="anchor" aria-label="anchor" href="#pull-requests"></a>
</h4>
<p>For a collaborative software development project you’ll typically
have multiple people contributing code to a range of branches. When the
development of the branch is complete the developer will submit a pull
request to have their changes/updates incorporated into a reference
branch (usually dev or main). A pull request is essentially a moderated
<code>git merge</code> (or <code>git rebase</code>) that allows you to
see any conflicts, see/discuss/approve changes, and make any final
changes required before the merge actually takes place.</p>
<p>People have the option of forking (copying) your public repository
and making their own changes. If you are lucky, people will make useful
changes to your code and then offer these changes back to you via a pull
request. If these changes are aligned with the goals of your project and
meet the various style and testing conditions that you set, then the
pull request should be accepted.</p>
<p>A pull request is a request. There is no necessity for all pull
requests to be accepted, however it is good practice (and polite) to
give feedback on any pull requests that are not going to be
accepted.</p>
<p>If you would like to capture the style, testing, and documentation
expectations for your project then a file called
<code>CONTRIBUTING.md</code> in the root of the repository is a common
place to define this. You can ask that people making pull requests obey
these expectations, and it is possible to create automated ways of
ensuring these standards are obeyed.</p>
</div>
</div>
<div class="section level3">
<h3 id="summary-2">Summary<a class="anchor" aria-label="anchor" href="#summary-2"></a>
</h3>
<p>Whether your development group is just you, or three, or ten people,
the issue tracker is a free and convenient workflow management
platform.</p>
<div id="group-activity-create-discuss-and-resolve-an-issue-on-github" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="group-activity-create-discuss-and-resolve-an-issue-on-github" class="callout-inner">
<h3 class="callout-title">GROUP Activity: Create, discuss, and resolve
an issue on GitHub</h3>
<div class="callout-content">
<p>Given the previous lessons, you should consider creating or updating
the <code>CONTRIBUTING.md</code> file for your project.</p>
<ol style="list-style-type: decimal">
<li>Have one member of your team create a new issue in the GitHub issue
tracker to create/update the file and assign the issue to at least one
other member of the team.</li>
<li>Tag the issue with a tag such as <code>documentation</code>, or
create a new tag that is more relevant.</li>
<li>Within your group, use the issue tracker to discuss what sections
are required for the <code>CONTRIBUTING.md</code> file.</li>
<li>Once there is a consensus on the content, have someone make the
required changes and push the file to GitHub (or edit directly online
using the GitHub editor).</li>
<li>Try using the <code>#&lt;IssueNumber&gt;</code> format within the
git commit to link the commit to the issue discussion.</li>
<li>When an acceptable file has been created/modified mark the issue as
resolved (closed).</li>
</ol>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="branching-and-development">Branching and development<a class="anchor" aria-label="anchor" href="#branching-and-development"></a>
</h2>
<hr class="half-width">
<p>In this lesson we’ll focus on one of the most popular git workflows:
<a href="https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow" class="external-link">Feature
Branching</a>. Many other workflows exist, but the most important
feature of any workflow is that it provides benefit to the project. See
the Atlassian tutorials on <a href="https://www.atlassian.com/git/tutorials/comparing-workflows" class="external-link">workflows</a>
for more information.</p>
<div class="section level3">
<h3 id="feature-branching">Feature branching<a class="anchor" aria-label="anchor" href="#feature-branching"></a>
</h3>
<p>At the core of the feature branching workflow is the idea that all
development should be done in a branch separate from the main branch.
The rational for this is to ensure that the main branch of the project
is always in a not-broken state. When people find your software
repository and want to try it out, they will most likely check out the
main branch and start their evaluation or usage journey from there.
Having a broken main branch is a good way to turn people away from your
software, and generate a lot of bug reports.</p>
<p>The diagram below shows the basic feature branch workflow.</p>
<figure><img src="fig/team/Feature-Branching-Workflow.png" alt="feature branching" class="figure mx-auto d-block"><div class="figcaption">feature branching</div>
</figure><p>In the above case a feature has been requested in the issue with
ticket number 123. A developer is assigned the task of developing this
feature and begins by creating a new branch with <code>git branch</code>
using a branch name appropriate for the task. The development proceeds
on the feature branch, occasionally breaking the code, fixing the bugs,
updating tests and documentation, until finally a new version of the
code has been created which implements the new feature. At this point
the developer responsible for this branch ensures all their changes are
pushed to Github and the opens a pull request. During the pull request
other developers, and maybe the person who submitted the initial feature
request, will review and discuss the changes, ensure that the code meets
the repository standards for style and quality. Once everyone is happy
with the changes in the feature branch it is merged into main by
accepting the pull request on Github. Once the feature branch has been
merged into main it is deleted.</p>
<p>In this scheme many features branches can be created, developed, and
then deleted over the life-cycle of the project.</p>
<p>A common variation on the feature branch workflow is to include a
development branch as an intermediary between the main and feature
branches. Feature branches are created off the develop branch and then
merged back when complete. The develop branch therefore contains all of
the latest features and if new features interact with each other in
unexpected ways, this can be discovered on the develop branch rather
than the main branch. The main branch is used for tagging and releasing
new versions of the software, and these new versions can each include a
number of developments.</p>
<figure><img src="fig/team/Feature-Branching-Workflow-1.png" alt="more feature branching" class="figure mx-auto d-block"><div class="figcaption">more feature branching</div>
</figure>
</div>
<div class="section level3">
<h3 id="setting-up-branches">Setting up branches<a class="anchor" aria-label="anchor" href="#setting-up-branches"></a>
</h3>
<p>Git does not see any branch as being special. We assign “specialness”
to a branch based on the name, but we can rename branches or change our
idea of special as we like. Regardless of how a git repository has been
set up, you can move from one branching scheme to another at any time.
Creating a new <code>develop</code> branch and then making a habit of
branching features from that instead of <code>main</code> can be done at
any time. The key thing is to make sure that the branching/development
workflow that you decide on is serving a purpose for your project. Early
on in the development of some software you may have a single developer
who is hashing out a proof of concept. In this case you may do all your
development right on the main branch. As you start to share your code
with others you may decide to move development into the develop branch,
and merge back to main only when the code-base is in a working state.
Finally, as you bring more developers into the project you may decide
that a feature-develop-main workflow is a better way to keep the various
developments from interfering with each other.</p>
<p>The point is that you should make a choice, write it down some place
(<code>CONTRIBUTING.md</code>), stick to that choice for as long as it
is useful, and revise it when needed.</p>
</div>
</section><section><h2 class="section-heading" id="an-example-development-cycle-for-fixing-a-bug">An example development cycle for fixing a bug<a class="anchor" aria-label="anchor" href="#an-example-development-cycle-for-fixing-a-bug"></a>
</h2>
<hr class="half-width">
<p>As I’m using my own code for various tasks I notice that</p>
<p><code>./scripts/sim_catalog --ref_ra=00:42:44.3 --ref_dec=-00:30:19 --radius 1 --n 1000</code></p>
<p>produces some unexpected output. A plot of the sky locations is shown
below. Note that the points have been generated around a central
declination of <code>00:30:19</code> instead of <code>-00:30:19</code>.
It seems that there is an issue with a negative reference
declination.</p>
<figure><img src="fig/team/diagnostic-plot.png" alt="diagnostic plot" class="figure mx-auto d-block"><div class="figcaption">diagnostic plot</div>
</figure><div class="section level3">
<h3 id="reporting-the-issue">Reporting the issue<a class="anchor" aria-label="anchor" href="#reporting-the-issue"></a>
</h3>
<p>As a user, once I have identified an issue I should go to github and
make a bug report on the issue tracker. In the example project I’m the
only on the developer team so I’ll assign myself to the issue. I’ll also
label it as being a bug.</p>
<figure><img src="fig/team/new-issue.png" alt="new issue" class="figure mx-auto d-block"><div class="figcaption">new issue</div>
</figure>
</div>
<div class="section level3">
<h3 id="confirming-the-issue">Confirming the issue<a class="anchor" aria-label="anchor" href="#confirming-the-issue"></a>
</h3>
<p>Now that the issue has been submitted I’ll tackle this problem from
the developer point of view.</p>
<p>The first thing to do is read and understand the issue. In this case
I’ll just run the script exactly as shown in the issue tracker, and see
that I get the same problem.</p>
</div>
<div class="section level3">
<h3 id="create-a-feature-branch-for-this-issue">Create a feature branch for this issue<a class="anchor" aria-label="anchor" href="#create-a-feature-branch-for-this-issue"></a>
</h3>
<p>At this point I should create a new branch in my repository with some
relevant name. Since the names of issues are not guaranteed to be unique
I will instead use the issue number (#1 in this case) as part of the
branch name. For a project with multiple developers it is also a good
idea to identify who is the ‘owner’ of each branch. An example branch
choice would be:</p>
<p><code>git branch Paulhancock/Issue#1</code></p>
<p>After some trial and error I find that the cause of the bug is in the
following code:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">def</span> generate_positions(ref_ra<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                       ref_dec<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                       radius<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                       nsources<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>...</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="co"># convert DMS -&gt; degrees</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    d, m, s <span class="op">=</span> ref_dec.split(<span class="st">':'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    dec <span class="op">=</span> <span class="bu">int</span>(d)<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>...</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="cf">return</span> ras, decs</span></code></pre>
</div>
<p>The first thing that I do is to make a new test that will expose this
bug.</p>
</div>
<div class="section level3">
<h3 id="writing-a-test">Writing a test<a class="anchor" aria-label="anchor" href="#writing-a-test"></a>
</h3>
<p>We will now write our first formal test for our code. We’ll use a
format that will make future automated testing easier. All the tests
that we wish to run are python scripts, and we’ll place them in the
<code>tests/</code> directory. Each script will test a different
sub-module, and for the <code>sim</code> sub-module of our
<code>skysim</code> module, we’ll collect all the tests into
<code>tests/test_sim.py</code>.</p>
<p>The first thing that we need to do is import the module/code that
will be tested. In this case that will be the
<code>generate_positions</code> function within the
<code>skysim.sim</code> module.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#! /usr/bin/env python3</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">Tests for the skysim.sim module</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="im">from</span> skysim.sim <span class="im">import</span> generate_positions</span></code></pre>
</div>
<p>Each test that we write will be contained within a separate function
whose name begins with <code>test_</code>, and which returns
<code>None</code> when the test passes, and raises an
<code>AssertionError</code> if the test fails. While we could home-brew
our own set of standards for what pass/fail looks like, we will instead
use standards set out by one of the common python testing frameworks
called <code>pytest</code>.</p>
<p>We craft a piece of code that will detect the mistake in our original
function. In this case the mistake is that the negative sign at the
start of the declination is being ignored so we get the wrong positions.
To test for this we’ll run <code>generate_positions</code> with a
declination that is negative, and small radius, so that the expected
output should consist entirely of negative declinations if the function
works properly, and probably all positive declinations if it’s
broken.</p>
<p>Our test function looks like this:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">def</span> test_negative_dec():</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">    Test for the negative dec bug noted in issue #1</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    _, decs <span class="op">=</span> generate_positions(ref_ra<span class="op">=</span><span class="st">'00:00:00'</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>                                 ref_dec<span class="op">=</span><span class="st">'-00:30:19'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>                                 radius<span class="op">=</span><span class="fl">0.1</span>, nsources<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> np.<span class="bu">all</span>(decs <span class="op">&lt;</span> <span class="dv">0</span>):</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">AssertionError</span>(<span class="st">"Declinations should be &lt;0, but are &gt;0"</span>)</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    <span class="cf">return</span></span></code></pre>
</div>
<p>In order to run the tests we can add the following snippet to the end
of our script. The snippet essentially looks at all the global variables
(including function names), selects those that start with
<code>test_</code>, assumes that they are a function and calls that
function. When the function is called there is a try/except for an
<code>AssertionError</code> which reports failure if it’s caught, or
reports success if no error was raised.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>    <span class="co"># introspect and run all the functions starting with 'test'</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>    <span class="cf">for</span> f <span class="kw">in</span> <span class="bu">dir</span>():</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>        <span class="cf">if</span> f.startswith(<span class="st">'test'</span>):</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>            <span class="cf">try</span>:</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>                <span class="bu">globals</span>()[f]()</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>            <span class="cf">except</span> <span class="pp">AssertionError</span> <span class="im">as</span> e:</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st"> FAILED with error: </span><span class="sc">{1}</span><span class="st">"</span>.<span class="bu">format</span>(f, e))</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">"</span><span class="sc">{0}</span><span class="st"> PASSED"</span>.<span class="bu">format</span>(f))</span></code></pre>
</div>
<p>When we run our test code we get the following result:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">$</span> python tests/test_sim.py </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="ex">test_negative_dec</span> FAILED with error Declinations should be <span class="op">&lt;</span>0, but are <span class="op">&gt;</span>0</span></code></pre>
</div>
<p>This failure is not a bad thing, it means that we have successfully
written a test function that will identify the bug. Now we can begin the
process of fixing the bug.</p>
</div>
<div class="section level3">
<h3 id="fixing-the-bug">Fixing the bug<a class="anchor" aria-label="anchor" href="#fixing-the-bug"></a>
</h3>
<p>Finally, once I have the test code in place, it’s time to fix the
bug. I make some modifications to account for the leading minus sign on
the declination as follows:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>    <span class="co"># convert DMS -&gt; degrees</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>    d, m, s <span class="op">=</span> ref_dec.split(<span class="st">':'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    sign <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    <span class="cf">if</span> d[<span class="dv">0</span>] <span class="op">==</span> <span class="st">'-'</span>:</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>        sign <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    dec <span class="op">=</span> sign<span class="op">*</span>(<span class="bu">abs</span>(<span class="bu">int</span>(d))<span class="op">+</span><span class="bu">int</span>(m)<span class="op">/</span><span class="dv">60</span><span class="op">+</span><span class="bu">float</span>(s)<span class="op">/</span><span class="dv">3600</span>)</span></code></pre>
</div>
<p>And I then re-run the code to make sure that the bug has been
resolved, and then run my tests:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">$</span> python tests/test_sim.py </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="ex">test_negative_dec</span> PASSED</span></code></pre>
</div>
<p>As I develop more and more tests the list of functions run will grow.
Once the new bug has been solved I will re-run <strong>all</strong> my
tests to ensure that fixing this bug has not caused a new bug some other
place.</p>
</div>
<div class="section level3">
<h3 id="checking-in-my-work">Checking in my work<a class="anchor" aria-label="anchor" href="#checking-in-my-work"></a>
</h3>
<p>I now check in my new test code, and updated version of sim.py:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">git</span> add tests/test_sim.py</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">'expose bug from issue#1'</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">'resolve #1'</span> skysim/sim.py</span></code></pre>
</div>
<p>Note that I have used <code>#1</code> to refer to the issue from
within my commit message. When viewed on Github these commit messages
will automatically generate a link to the issue, and when viewing the
issue I should be able to see the reverse link.</p>
<p>I now push the bug fix (and my new branch) to the Github repo.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">git</span> push <span class="at">--set-upstream</span> origin Paulhancock/Issue#1</span></code></pre>
</div>
<p>If we look on the original issue page, we can see the link to the
commit.</p>
<figure><img src="fig/team/issue-reference.png" alt="issue referenced in commit" class="figure mx-auto d-block"><div class="figcaption">issue referenced in commit</div>
</figure>
</div>
<div class="section level3">
<h3 id="creating-a-pull-request">Creating a pull request<a class="anchor" aria-label="anchor" href="#creating-a-pull-request"></a>
</h3>
<p>When we navigate to the landing page for our repository we will see a
new yellow banner appear as below:</p>
<figure><img src="fig/team/repo-with-updates-on-branch.png" alt="github issue with recent updates on branch" class="figure mx-auto d-block"><div class="figcaption">github issue with recent updates on branch</div>
</figure><p>We can click the green “Compare &amp; pull request” button to start a
new pull request. Alternatively we can go to the “Pull requests” tab.
Either way we enter a title and description for the pull request.</p>
<p>Note that the assign/label/project/milestone options that we see on
the pull request form are mostly the same as on the Issues form. This is
because pull requests are just special types of issues. They share a
numbering scheme. This is the first pull request for this repository but
it will be labelled <code>#2</code> because there is an existing issue
<code>#1</code>. One difference between a pull request and an issue is
that a pull request can have a reviewer assigned to it. Here I have
selected myself as the assignee (the person looking after the pull
request), and <code>SkyWa7ch3r</code> as the reviewer (the person who
will review my code and sign off when they are happy).</p>
<figure><img src="fig/team/new-PR.png" alt="new pull request" class="figure mx-auto d-block"><div class="figcaption">new pull request</div>
</figure><p>Github does some work in the background to let me know that there
will be no conflicts between this branch and the main branch, so that it
is ‘safe’ to do the merge. Currently there is no indication that the
code works or passes our tests. For now we let the reviwer do this work.
The reviewer would pull the <code>Paulhancock/Issue#1</code> branch, run
the tests and see that they pass, then come back to github and make a
note of it in the discussion. (In a later lesson we’ll see how we can
make Github do most of this work for us using Github actions.)</p>
<figure><img src="fig/team/PR-with-reviewer-comment.png" alt="pull request with a reviewer comment" class="figure mx-auto d-block"><div class="figcaption">pull request with a reviewer comment</div>
</figure><p>Once our reviewer(s) are happy with the changes we can merge our
branch back into main by pressing the green button. This will create a
new commit on the main branch in order to do the merge, so we’ll be
asked for a title/description for the commit. It is pre-filled for us.
Once the merge is complete Github will let us know that all is good, and
suggest that we delete the branch. Since the feature is merged we no
longer need this branch and will delete it.</p>
<figure><img src="fig/team/PR-merged.png" alt="pull request merged" class="figure mx-auto d-block"><div class="figcaption">pull request merged</div>
</figure>
</div>
<div class="section level3">
<h3 id="closing-the-issue">Closing the issue<a class="anchor" aria-label="anchor" href="#closing-the-issue"></a>
</h3>
<p>If we navigate back to the issues tab, we’ll see that the issue
related to the pull request has also been closed for us. This is because
we wrote <code>resolve #1</code> as a comment for our commit. When that
commit is merged into the main branch git will automatically resolve
(close) the linked issue. If we didn’t use this smart linking capability
we can still go back to the open issue and close it. Either way it would
be good to leave a note about the issue being fixed.</p>
</div>
<div class="section level3">
<h3 id="summary-3">Summary<a class="anchor" aria-label="anchor" href="#summary-3"></a>
</h3>
<p>The development cycle for fixing a bug is as follows:</p>
<ul>
<li>identify bug</li>
<li>report bug on the Gihub issue tracker</li>
<li>confirm that the bug exists</li>
<li>create a feature branch</li>
<li>write a test to expose the bug/error</li>
<li>fix the bug</li>
<li>run all tests</li>
<li>commit changes</li>
<li>create a pull request</li>
<li>merge the branch into main and delete the feature branch</li>
</ul>
<p>In this example we had one person doing the reporting/fixing. Usually
you’ll have an end user doing the finding/report part, and then one or
more developers doing the remainder.</p>
<div id="group-activity-working-on-the-same-problem" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="group-activity-working-on-the-same-problem" class="callout-inner">
<h3 class="callout-title">GROUP Activity: Working on the same
problem</h3>
<div class="callout-content">
<p>In this activity you will practice working in a team as you go
through a simple development cycle.</p>
<ol style="list-style-type: decimal">
<li>As a group, identify a minor issue with your current project. (Don’t
feel bad, the only projects that don’t have issues are the ones that no
one is using).</li>
<li>Since the focus here is on the life-cycle of a bug, choose a small
thing that is easy to identify and fix.</li>
<li>A function without a docstring would be ideal (and probably easy to
find).</li>
<li>Have one team member create an issue that describes the problem and
explains what a solution would look like.</li>
<li>eg “myFunc(4) should return a filename”, or “myFunc should have a
docstring in <format>”.</format>
</li>
<li>Create a new branch for development work called <feature> or
Issue<number>.</number></feature>
</li>
<li>Assign <strong>at least two team members</strong> to work on this
issue.</li>
<li>Have <strong>one team member</strong> create a solution for the
issue and then:</li>
<li>Push the changes to the remote repository,</li>
<li>Open a pull request to merge this branch into main,</li>
<li>Set the assignees to be all the members working on the issue,</li>
<li>Set the reviewer to be a team member who is not working on the code
(if you have enough people, otherwise choose someone other than the pull
request creator), and</li>
<li>Add whatever labels look appropriate.</li>
<li>Have <strong>the other team members</strong>:</li>
<li>View the changes via the “files changed” tab of the pull
request,</li>
<li>Comment on what is good and what needs improving,</li>
<li>Pull the active branch to their local machine,</li>
<li>Make an improvement and commit the change, and</li>
<li>Push the change back to the active branch.</li>
<li>Everyone should have an opportunity to make comments and changes,
but you’ll need to coordinate who is doing what and when to minimise the
number of merge conflicts that occur.</li>
<li>Once everyone has had a chance to view/comment/change, have the
reviewer sign off on the pull request and merge the changes into the
main branch.</li>
</ol>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-ReusableCode"><p>Content from <a href="ReusableCode.html">Making Code Reusable by You and Your Group</a></p>
<hr>
<p>Last updated on 2026-02-25 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/ReusableCode.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I easily share or re-use my code?</li>
<li>When sharing, what information should I provide?</li>
<li>Where and how can I easily share code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Package your code into a module.</li>
<li>Create a command line interface for your code.</li>
<li>Identify and include meta-data in your module.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="separating-the-ui-from-the-functionality">Separating the UI from the functionality<a class="anchor" aria-label="anchor" href="#separating-the-ui-from-the-functionality"></a>
</h2>
<hr class="half-width">
<p>A programming principle called <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller" class="external-link">model-view-controller</a>
(MVC) is recommended when designing code. Under MVC, programs are
separated into one of three components, the model (library) which
provides the core functionality, a viewer which provides a visualisation
of the results, and a controller which links the user to the model. In
our test code the model would be the two functions
<code>generate_positions</code> and <code>write_file</code>, whilst the
controller would be the command line interface. [In this example we
could consider the file output to be the viewer.]</p>
<p>At the end of cycle1 we had a single file, <code>sim.py</code>, which
contained both the model and the controller. Our first task will be to
separate this into two parts. The first part will be a python module
which provides the functionality, and the second will be a script which
receives user input and calls the library functions.</p>
<div class="section level3">
<h3 id="creating-a-python-module">Creating a python module<a class="anchor" aria-label="anchor" href="#creating-a-python-module"></a>
</h3>
<p>Python modules, like the <code>numpy</code> module that we have
already used, can be easily created by obeying a simple directory/file
structure. If we want to create a module called <code>skysim</code> then
all we need to do is create a directory with the same name, and add an
empty file called <code>__init__.py</code>. Let’s do that now:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> mkdir skysim</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="ex">$</span> touch skysim/__init__.py</span></code></pre>
</div>
<p>To access the module we simply use <code>import skysim</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">$</span> python</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">skysim</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dir<span class="kw">(</span><span class="ex">skysim</span><span class="kw">)</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="ex">[</span><span class="st">'__builtins__'</span><span class="ex">,</span> <span class="st">'__cached__'</span>, <span class="st">'__doc__'</span>, <span class="st">'__file__'</span>, <span class="st">'__loader__'</span>, <span class="st">'__name__'</span>, <span class="st">'__package__'</span>, <span class="st">'__path__'</span>, <span class="st">'__spec__'</span>]</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> </span></code></pre>
</div>
<p>We can see that the <code>skysim</code> module already has some
attributes defined, and they all start with a double underscore (
<code>__</code> or ‘dunder’ ). The <strong>file</strong> attribute is a
string containing the full path to the file <code>__init__.py</code>.
The <code>__name__</code> attribute will contain the string
<code>skysim</code> because this is the name of the module. If we had
renamed the module on import (using <code>import skysim as other</code>)
then the <code>__name__</code> attribute would still be the same. Feel
free to explore the other attributes.</p>
<p>In order to add some functions or attributes to our module we can
simply add our <code>sim.py</code> file to the <code>skysim</code>
directory. If we do this and then restart our python interpreter we can
import all the functions/modules/variables provided by
<code>sim.py</code> by doing <code>from skysim import sim</code>. For
example:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">$</span> python</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">skysim</span> import sim</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> dir<span class="kw">(</span><span class="ex">sim</span><span class="kw">)</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="ex">[</span><span class="st">'__builtins__'</span><span class="ex">,</span> <span class="st">'__cached__'</span>, <span class="st">'__doc__'</span>, <span class="st">'__file__'</span>, <span class="st">'__loader__'</span>, <span class="st">'__name__'</span>, <span class="st">'__package__'</span>, <span class="st">'__spec__'</span>, <span class="st">'argparse'</span>, <span class="st">'generate_positions'</span>, <span class="st">'math'</span>, <span class="st">'np'</span>, <span class="st">'write_file'</span>]</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> </span></code></pre>
</div>
<p>Above we can see the two functions that we defined, as well as the
modules that we imported (<code>argparse</code>, <code>math</code>, and
<code>np</code>). We now have a library that we can import. When we
import a module, all the code within that file is executed. In the case
of our <code>sim.py</code> file this means that we import some other
modules and then define some functions.</p>
<p>If a python file is run via <code>python myfile.py</code> then the
<code>__name__</code> attribute will be set to the string
<code>__main__</code>. However if a python file is imported via import
myfile or <code>import myfile as mf</code>, then the
<code>__name__</code> attribute is set to be the filename (without the
<code>.py</code> extension). Therefore when we import
<code>sim.py</code> as part of our module the CLI that we created with
argparse does not get executed because we hid it within an
<code>if __name__ == "__main__"</code> clause.</p>
</div>
<div class="section level3">
<h3 id="creating-a-stand-alone-script">Creating a stand alone script<a class="anchor" aria-label="anchor" href="#creating-a-stand-alone-script"></a>
</h3>
<p>To create a script that calls this library we create a new file
called <code>sim_catalog</code>. We then move all the content of the
<code>if __name__ == "__main__"</code> clause out of <code>sim.py</code>
and into our new file. Finally, we the import the functions that we need
from our newly created module.</p>
<p>Our new script looks like this:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#! /usr/bin/env python</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="im">import</span> argparse</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="im">from</span> skysim.sim <span class="im">import</span> generate_positions, write_file</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="co"># Set up the parser with all the options that you want</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    parser <span class="op">=</span> argparse.ArgumentParser(prog<span class="op">=</span><span class="st">'sim'</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    group1 <span class="op">=</span> parser.add_argument_group()</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    group1.add_argument(<span class="st">'--ref_ra'</span>, dest<span class="op">=</span><span class="st">'ref_ra'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Central/reference RA position HH:MM:SS.S format'</span>)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    group1.add_argument(<span class="st">'--ref_dec'</span>, dest<span class="op">=</span><span class="st">'ref_dec'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Central/reference Dec position DD:MM:SS.S format'</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    group1.add_argument(<span class="st">'--radius'</span>, dest<span class="op">=</span><span class="st">'radius'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">float</span>, default<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'radius within which the new positions are generated (deg)'</span>)</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    group1.add_argument(<span class="st">'--n'</span>, dest<span class="op">=</span><span class="st">'nsources'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">int</span>, default<span class="op">=</span><span class="dv">1_000</span>,</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Number of positions to generate'</span>)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    group1.add_argument(<span class="st">'--out'</span>, dest<span class="op">=</span><span class="st">'outfile'</span>, <span class="bu">type</span><span class="op">=</span><span class="bu">str</span>, default<span class="op">=</span><span class="st">'catalog.csv'</span>,</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>                        <span class="bu">help</span><span class="op">=</span><span class="st">'Filename for saving output (csv format)'</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>    <span class="co"># parse the command line input</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>    options <span class="op">=</span> parser.parse_args()</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>    ras, decs <span class="op">=</span> generate_positions(ref_ra<span class="op">=</span>options.ref_ra,</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>                                   ref_dec<span class="op">=</span>options.ref_dec,</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>                                   radius<span class="op">=</span>options.radius,</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>                                   nsources<span class="op">=</span>options.nsources)</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>    write_file(ras, decs, outfile<span class="op">=</span>options.outfile)</span></code></pre>
</div>
<p>Note that we have a <a href="https://en.wikipedia.org/wiki/Shebang_(Unix)" class="external-link">shebang</a> line
(#!) to indicate that we want to use the python interpreter. This means
that we can make the file executable and then execute it like any other
program without the user having to explicitly type <code>python</code>.
It is not shown here, but I have made the file executable so that I can
just type <code>./sim_catalog</code> to run the above code.</p>
<p>We have now separated our interface (<code>sim_catalog</code>) from
the model (<code>skysim.sim</code>). Currently the user will not notice
any difference because the functionality hasn’t changed. However, we are
now able to import the model into other python scripts. Our code is
becoming easier to re-use by ourselves (and other developers).</p>
</div>
<div class="section level3">
<h3 id="updating-our-test-script">Updating our test script<a class="anchor" aria-label="anchor" href="#updating-our-test-script"></a>
</h3>
<p>Finally, we just need to update our test script so that it will use
the new <code>sim_catalog</code> script to do the testing.</p>
<div id="solo-activity-command-line-interface" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="solo-activity-command-line-interface" class="callout-inner">
<h3 class="callout-title">SOLO Activity: Command line interface</h3>
<div class="callout-content">
<p>A command line interface (CLI) is a good way to allow non-developers
to use your software. In the previous lesson we saw how we can separate
the functionality of your software from the user interface by creating a
module with the core functionality and a script to provide the user
interface.</p>
<p>Using the <a href="https://github.com/ADACS-Australia/MAP21B-Training-BPindor/tree/cycle2" class="external-link">example
project</a> we developed earlier:</p>
<ol style="list-style-type: decimal">
<li>Update the <code>scripts/sim_catalog</code> file so that it now has
two argument groups,
<ol style="list-style-type: decimal">
<li>The current <code>group1</code> should have a <code>title</code> of
“Program settings”</li>
<li>The second group (<code>group2</code>) should have a
<code>title</code> of “Metadata”</li>
</ol>
</li>
<li>Add the following parameters to <code>group2</code>:
<ol style="list-style-type: decimal">
<li>
<code>--version</code>, which will print the version</li>
<li>
<code>--date</code>, to show the last modified date</li>
<li>
<code>--author</code>, to list the authors</li>
</ol>
</li>
<li>All the parameters in <code>group2</code> should have a
<code>default</code> value of <code>False</code>, and then use
<code>action='store_true'</code> to set the parameter to
<code>True</code> when this option is supplied by the user.</li>
<li>[Optional] Provide shortened versions of the parameters in
<code>group2</code> of the format <code>-c</code> etc..</li>
<li>Write the necessary code so that when any of the options in
<code>group2</code> are set, all the required information is printed and
the program exits without performing the simulation.</li>
</ol>
<p>For now you’ll have to define some variables within the script to
hold these values, but later on we’ll demonstrate a better place to
store them.</p>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="setting-up-a-python-environment">Setting up a python environment<a class="anchor" aria-label="anchor" href="#setting-up-a-python-environment"></a>
</h2>
<hr class="half-width">
<p>You python environment is the ecosystem of modules that you have
installed. If you have used <code>pip</code> to install modules then
<code>pip freeze</code> will give you a list of all the currently
installed modules and their versions. If you used <code>conda</code>
(anaconda) to install modules then <code>conda list</code> will do the
same. If you use a combination of the two then you are likely heading
toward the following problem:</p>
<figure><img src="fig/reuse/python_environment.png" alt="From https://xkcd.com/1987" class="figure mx-auto d-block"><div class="figcaption">From <a href="https://xkcd.com/1987" class="external-link uri">https://xkcd.com/1987</a>
</div>
</figure><p>If you have ever sent a python script to a collaborator only for them
to say that it doesn’t work on their machine, it’s likely that they have
a different set of modules installed, or that they have a different
version of the modules installed. It may feel like installing all the
modules at once would help out. But different software may depend on
different versions of the same modules which would require you to
uninstall/reinstall different versions of modules depending on what you
are working on.</p>
<p>A better solution is to install multiple different python
environments – one for each piece of software that you wish to run. To
do this we will work with virtual environments.</p>
<div class="section level3">
<h3 id="creating-a-new-virtual-environment">Creating a new virtual environment<a class="anchor" aria-label="anchor" href="#creating-a-new-virtual-environment"></a>
</h3>
<p>With the introduction of python 3, there is now a new module called
<code>venv</code> which handles the creation of new virtual
environments. See the <a href="https://docs.python.org/3/tutorial/venv.html" class="external-link">python
documentation</a> for a full breakdown. The short version is that we can
create a new virtual environment simply via:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> venv [--prompt PROMPT] ENV_DIR </span></code></pre>
</div>
<p>where PROMPT is the name of the virtual environment, and ENV_DIR is
the location in which all the files for this environment will be stored.
A nice place to store your ENV_DIR is in your home directory.</p>
<p>Once you have created a virtual environment you can activate it
via:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">source</span> ENV_DIR/bin/activate</span></code></pre>
</div>
<p>I find it nice to have a descriptive ENV_DIR such as
<code>.env-jupyter</code> or <code>.env-py3-myproject</code> (where the
‘.’ indicates a hidden directory in linux) but a short PROMPT such as
<code>jpy</code>, or <code>py3-myproj</code>. The reason for this is
that once your project is activated, your terminal will have PROMPT
added to the start of your command line. Since my PROMPT and ENV_DIR are
different I then add an alias in my <code>~/.bash_aliases</code> file to
link them:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="bu">alias</span> jpy=<span class="st">'source ~/.env-jupyter/bin/activate'</span></span></code></pre>
</div>
<p>Creating a new virtual environment is easy, and if you get it wrong,
you can just delete the ENV_DIR. The other nice thing is that if you are
on a Linux or OSX machine your system version of python (which is used
by the OS) can remain untouched, and won’t cause your system to become
flaky when you totally mess up your python installs.</p>
<p>If you use Anaconda to install/manage your python modules, then you
can simply navigate to the ‘environments’ tab, and create a new
environment with the click of a button.</p>
<p>Now that we have created a new python environment we need to install
some things into it.</p>
</div>
</section><section><h2 class="section-heading" id="preserving-environments-with-requirements-txt-or-environment-yml">Preserving environments with requirements.txt or
environment.yml<a class="anchor" aria-label="anchor" href="#preserving-environments-with-requirements-txt-or-environment-yml"></a>
</h2>
<hr class="half-width">
<p>Once you and your collaborators are comfortable managing different
python virtual environments you are all set to start exporting and
importing those environments for sharing.</p>
<p>The simplest way to share a python environment is to use a file which
lists all the modules that are installed, and even their versions. Pip
and conda have different ways of capturing dependencies.</p>
<div class="section level3">
<h3 id="pip-requirements-txt">pip – requirements.txt<a class="anchor" aria-label="anchor" href="#pip-requirements-txt"></a>
</h3>
<p>For our example project we have used only one non-builtin python
module: <code>numpy</code>. To specify that this is module is required
we can create a file called <code>requirements.txt</code> and add the
following:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="ex">numpy</span><span class="op">&gt;</span>=1.19</span></code></pre>
</div>
<p>where the <code>&gt;=1.19</code> indicates that version 1.19 or
greater will be fine. See the <a href="https://pip.pypa.io/en/stable/reference/requirements-file-format/#example" class="external-link">pip
documentation</a> for examples on how you can specify different version
numbers, ranges, and exclusions. By default each module listed will be
installed from the python package index (pypi), but you can also
indicate other locations including local files/folders or github
repositories.</p>
<p>If you don’t know what versions or dependencies you need for your
particular project then you can get a hint by inspecting your current
environment using <code>pip freeze</code>. This will list all the
installed modules and versions for the current environment. The list
will be much longer than you anticipate! To get a minimal list, start
with an empty environment and then keep installing modules until your
software will run, then run
<code>pip freeze &gt;&gt; requirements.txt</code>.</p>
<p>To install all the modules within a <code>requirements.txt</code>
file you run pip:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre>
</div>
<p>You now have a way of preserving and sharing your python environment
with others. It is good practice to keep a <code>requirements.txt</code>
file in your project directory, and to have this as part of your version
control repository.</p>
</div>
<div class="section level3">
<h3 id="conda-environment-yml">conda – environment.yml<a class="anchor" aria-label="anchor" href="#conda-environment-yml"></a>
</h3>
<p>Anaconda uses a slightly different file format to capture essentially
the same information. For the above example our file would look
like:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="ex">dependencies:</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>  <span class="ex">-</span> numpy<span class="op">&gt;</span>=1.19</span></code></pre>
</div>
<p>Anaconda is able to reproduce not just the python modules, but the
entire virtual environment including the versions of python and anaconda
and also other non-python based codes. You can generate a good starting
point using <code>conda list --export</code>.</p>
<p>In order to 1) not dictate your users’ virtual environment management
choices, and 2) not duplicate information, the following method will
link your <code>environment.yml</code> and <code>requirements.txt</code>
files:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">name:</span> my-env</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="ex">dependencies:</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="ex">-</span> python<span class="op">&gt;</span>=3.8</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="ex">-</span> anaconda</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="ex">-</span> pip</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  <span class="ex">-</span> pip:</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    <span class="ex">-</span> <span class="at">-r</span> requirements.txt</span></code></pre>
</div>
<p>Conda understands pip formatted requirements, but pip doesn’t
understand conda environment files, so there is no inverse version of
the above linking.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>In combination with a python virtual environment (previous lesson),
we now have a greater expectation that our software will run the same on
other people’s machines as is does on our own (test) machine. There will
be some localisation (win/linux/osx) or language (en, ch, fr, etc)
difference that might cause some problems down the line, but we have
solved one of the most common sources of error.</p>
</div>
</section><section><h2 class="section-heading" id="useful-project-metadata">Useful project metadata<a class="anchor" aria-label="anchor" href="#useful-project-metadata"></a>
</h2>
<hr class="half-width">
<p>Previously we used an empty <code>__init__.py</code> file in a
directory to cause python to interpret that directory as a module. There
is meta data that we wish to store about our project, and the
<code>__init__.py</code> file is an excellent place to do this.</p>
<div class="section level4">
<h4 id="versioning">Versioning<a class="anchor" aria-label="anchor" href="#versioning"></a>
</h4>
<p>One of the most common items to store is the version of your
software. For most modules the <code>module.__version__</code> is used
to store this information. There are many conventions for software
versioning and no one single correct answer. Versioning is the practice
of using unique numbers of names to refer to the different states of a
software project or code. A common choice is to use major/minor/patch
versions for the code such as <code>4.2.1</code>, which is used by most
python modules. See <a href="https://semver.org/spec/v2.0.0.html" class="external-link">semver.org</a> for a
description on the how and why of semantic versioning.</p>
<p>A major version change will usually mean that the code has changed in
some fundamental way, and that people should not expect compatibility
between the two versions. For example: there were many changes between
the last version of python 2 (2.7) and python 3 that meant not all code
would work on both versions. If you have been using python for a while,
or have seen python code from ~10 years ago (or ~2 years ago if it’s
astronomers’ code!), then you’ll have seen some of these changes. Most
notable is the change from <code>print "hello"</code> to
<code>print("hello")</code>.</p>
<p>A minor version change will usually indicate changes have been made
that do not break compatibility within the major version. This would
usually include the addition of new functionality that is compatible
with (but not available in) previous versions of the software.</p>
<p>A patch version is used to distinguish states of development that do
not change the intended functionality of the code base. These include
bug fixes, security patches, or documentation updates.</p>
<p>Typically version 1.0 is used to represent the first stable/complete
version of the software, and so versions such as 0.9 are used to
indicate development versions.</p>
</div>
<div class="section level4">
<h4 id="modification-date">Modification date<a class="anchor" aria-label="anchor" href="#modification-date"></a>
</h4>
<p>In addition to a semantic versioning noted above, some developers
find it useful to record the date of last change for each version of
their software (and indeed each file/module within). For this purpose we
would make use of the <code>module.__date__</code> attribute. Date
formats are a perpetual problem for people and computers alike so it is
recommended that a single format be chosen and used consistently
throughout a project. The format YYYY-MM-DD is recommended as it has the
advantage of being time sorted when sorted alphanumerically.</p>
</div>
<div class="section level4">
<h4 id="authors-developers">Authors / developers<a class="anchor" aria-label="anchor" href="#authors-developers"></a>
</h4>
<p>One method tracking attribution (or blame) in a project is to use the
<code>module.__author__</code> attribute to store the author name as
either a string or list. For a project with few developers this can be
handled easily. For larger groups or projects <code>git blame</code>
would be a better method for tracking contributions on a line by line
basis.</p>
</div>
<div class="section level4">
<h4 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h4>
<p>For any researcher writing software there is an eternal battle
between writing good code and “doing science”. Acknowledging the use of
software is common but not yet standard or required when publishing
papers. To make it easier for people to cite your work you can use an
attribute such as <code>module.__citation__</code> to employer people to
cite your work, link to papers or code repositories that should be cited
or referenced. When combined with a <code>--cite</code> command line
option, this is a great way for people to properly credit your work. If
your target audience are researchers then it can be very useful to store
a bibtex entry in the citation string so that people can just copy/paste
into their LaTeX document.</p>
</div>
<div class="section level3">
<h3 id="meta-data-for-our-example-project">Meta data for our example project<a class="anchor" aria-label="anchor" href="#meta-data-for-our-example-project"></a>
</h3>
<p>The <code>__init__</code> file in our example project can be updated
to include the above recommendations. Note the format of the
<code>__citation__</code> string being multi line, and including LaTeX
formatting.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># /usr/bin/env python</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>__author__ <span class="op">=</span> [<span class="st">'Dev One'</span>, <span class="st">'Contrib Two'</span>]</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>__version__ <span class="op">=</span> <span class="st">'0.9'</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>__date__ <span class="op">=</span> <span class="st">'2021-12-02'</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>__citation__ <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="st">% If this work is used to support a publication please</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="sc">% c</span><span class="st">ite the following publication:</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="st">% Description of This code</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="st">@ARTICLE{ExcellentCode_2022,</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="st">   author = </span><span class="sc">{{</span><span class="st">One}, D. and </span><span class="sc">{Two}</span><span class="st">, C. and </span><span class="sc">{People}</span><span class="st">, O},</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="st">    title = "{Awesome sauce code for astronomy projects}",</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="st">  journal = </span><span class="sc">{Nature}</span><span class="st">,</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="st"> keywords = {techniques: image processing, catalogues, surveys},</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="st">     year = 2021,</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="st">    month = may,</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="st">   volume = 1337,</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="st">    pages = {11-15},</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="st">      doi = {some.doi/link.in.here}</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="st">% It is also appropriate to link to the following repository:</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="st">https://github.com/devone/AwesomeSauce</span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="st">"""</span></span></code></pre>
</div>
<div id="group-activity-metadata" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="group-activity-metadata" class="callout-inner">
<h3 class="callout-title">GROUP Activity: metadata</h3>
<div class="callout-content">
<p>In the past few lessons we learned about virtual environments, and
project metadata. We will now put some of these lessons in to
practice.</p>
<p>As a group:</p>
<ol style="list-style-type: decimal">
<li>Decide upon a versioning scheme that will be used for the project,
and if none currently exists, agree on what the current version number
should be.</li>
<li>Discuss how people should give recognition for using this project as
part of their research (or other) work.</li>
<li>Create issues on github that request the following changes. Share
the creation and assignee responsibilities between group members.
<ol style="list-style-type: decimal">
<li>The creation of a <code>requirements.txt</code> and
<code>environment.yml</code> file that include the dependencies for your
project. For each dependency specify the minimum version requirement to
be the smallest version that is used by one of the group members.</li>
<li>Record the agreed upon current version number of the project in the
<code>&lt;project&gt;/__init__.py</code> file.</li>
<li>Record the authors in an agreed upon order in the
<code>__init__.py</code> file</li>
<li>Record the last modification date in the <code>__init__.py</code>
file</li>
</ol>
</li>
<li>Describe the method by which people should cite or give recognition
for using this project</li>
<li>For each of the issues above, have a group member follow the
branch-develop-pull request workflow that was described earlier. When
creating pull requests set the reviewer to include the person who
created the initial issue.</li>
<li>[Optional] Once all the pull requests have been resolved, repeat the
previous SOLO activity for your project (creating a command line
interface that will give users access to the <code>--cite</code>,
<code>--date</code>, <code>--version</code>, <code>--author</code>
information.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section><h2 class="section-heading" id="licensing-your-work">Licensing your work<a class="anchor" aria-label="anchor" href="#licensing-your-work"></a>
</h2>
<hr class="half-width">
<p>By default any creative work is under an exclusive copyright which
means that the author(s) of that work have a say in what others can do
with it. In general this means that no one can build upon, use, reuse,
or distribute your work without your permission. To use or build upon
software that has no licence requires the new developer/user to contact
the original author(s) and get permission. This is time consuming,
annoying, and often not done. If you want your work to be used by others
your best bet is to provide an explicit software license as part of your
project so that people know up front what is allowed and not allowed. A
common way of licensing software is to provide a <code>LICENSE</code>
(or <code>LICENCE</code>) file in the root of the project.
(Alternatively you can provide the license as part of the header for
each file, but that’s a lot of repetition, and goes against our good
practice of don’t repeat yourself).</p>
<div class="section level3">
<h3 id="choosing-a-software-licence-for-your-project">Choosing a software licence for your project<a class="anchor" aria-label="anchor" href="#choosing-a-software-licence-for-your-project"></a>
</h3>
<p>Your home institute may have opinions/guidelines for appropriate
licensing software. Ask around and follow the advice of you local
experts.</p>
<p>If you don’t have any local constraints on licensing your software
you can use one of the many license templates available on Github. To
use a template you need to log into your Github account, navigate to
your repository and then click the “add file”-&gt;”create new file”
button. You will be presented with a blank text editor and be asked for
a file name. If you use <code>LICENSE.md</code> (or any similar
spelling/extension) then you’ll see a new button appear on the right of
the screen saying “Choose a licence template”. Click that.</p>
<figure><img src="fig/reuse/empty-licence.png" alt="Editing the LICENSE.md file" class="figure mx-auto d-block"><div class="figcaption">Editing the LICENSE.md file</div>
</figure><p>You’ll then see a list of common software licences that you can
choose from. If you are brave you can read each of them in full.
Alternatively you can simply read the Github provided summary at the top
of what the permissions/limitations are. Choose one that feels right to
you and then press “Review and submit”. This will create a new licence
file.</p>
<figure><img src="fig/reuse/licence-helper.png" alt="The github license helper" class="figure mx-auto d-block"><div class="figcaption">The github license helper</div>
</figure><p>Once you have a license file GitHub will add a badge to the “About”
section of your project like this:</p>
<figure><img src="fig/reuse/licence-listed.png" alt="Your license on github" class="figure mx-auto d-block"><div class="figcaption">Your license on github</div>
</figure><p>As you can see, for the example project I chose the GNU General
public licence.</p>
</div>
</section><section><h2 class="section-heading" id="basic-documentation-in-readme-md">Basic documentation in README.md<a class="anchor" aria-label="anchor" href="#basic-documentation-in-readme-md"></a>
</h2>
<hr class="half-width">
<p>Upon downloading new software, the first point of call for many
people is to look for some help on how to install and use the software.
This is where a file such as <code>INSTRUCTIONS</code>,
<code>INSTALL</code> or <code>README</code> can come in handy. The name
of the file says what it is and will attract the attention of the user.
While these files can be in any format, and have any name, a common
choice is <code>README.md</code>. If you have navigated to a GitHub
software repository, and seen the nice documentation available on the
front page, then this has been generated from the <code>README.md</code>
file.</p>
<p>The markdown format (<a href="https://www.markdownguide.org/" class="external-link">guide
here</a>) is a simple to use, future proof, platform independent,
document format that can be rendered into a range of other formats. As a
bonus, the raw files are easily read and written by humans.</p>
<div class="section level4">
<h4 id="things-to-consider-for-your-readme-md-file">Things to consider for your README.md file<a class="anchor" aria-label="anchor" href="#things-to-consider-for-your-readme-md-file"></a>
</h4>
<ul>
<li>The name of the project</li>
<li>A description of the purpose of the software</li>
<li>Maybe a one liner for each script</li>
<li>Install instructions</li>
<li>List some high level dependencies</li>
<li>Usage instructions</li>
<li>If you have a CLI then the output of <code>mycode --help</code> is
appropriate to include verbatim</li>
<li>A link to documentation</li>
<li>Author information and contact details (email, or just a link to
github issues)</li>
<li>A note on how people should credit this work</li>
</ul>
</div>
<div class="section level4">
<h4 id="readme-md-for-our-example-project">README.md for our example project<a class="anchor" aria-label="anchor" href="#readme-md-for-our-example-project"></a>
</h4>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># SkySim</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="ex">This</span> project was built in order to simulate source <span class="er">(</span><span class="ex">star/galaxy/other</span><span class="kw">)</span> <span class="ex">positions</span> over an area of sky.</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co">## Installing</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="ex">This</span> project relies only on python built-ins and the numpy library.</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="ex">Use</span> <span class="kw">`</span><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt<span class="kw">`</span> if you don<span class="st">'t yet meet these requirements.</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="st">## Usage</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="st">The main entry point for this project is `sim_catalog`:</span></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="st">./sim_catalog --help</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="st">usage: sim [-h] [--ref_ra REF_RA] [--ref_dec REF_DEC] [--radius RADIUS] [--n NSOURCES] [--out OUTFILE]</span></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="st">optional arguments:</span></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="st">  -h, --help         show this help message and exit</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a><span class="st">  --ref_ra REF_RA    Central/reference RA position HH:MM:SS.S format</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="st">  --ref_dec REF_DEC  Central/reference Dec position DD:MM:SS.S format</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="st">  --radius RADIUS    radius within which the new positions are generated (deg)</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="st">  --n NSOURCES       Number of positions to generate</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="st">  --out OUTFILE      Filename for saving output (csv format)</span></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a><span class="st">## Documentation</span></span>
<span id="cb13-25"><a href="#cb13-25" tabindex="-1"></a><span class="st">Documentation is currently just this file, and associated python docstrings.</span></span>
<span id="cb13-26"><a href="#cb13-26" tabindex="-1"></a></span>
<span id="cb13-27"><a href="#cb13-27" tabindex="-1"></a><span class="st">## Author / Contribution</span></span>
<span id="cb13-28"><a href="#cb13-28" tabindex="-1"></a><span class="st">This project is developed by Dev One.</span></span>
<span id="cb13-29"><a href="#cb13-29" tabindex="-1"></a><span class="st">If you want to contribute to this project please create a fork and issue pull requests for new features or bug fixes.</span></span>
<span id="cb13-30"><a href="#cb13-30" tabindex="-1"></a></span>
<span id="cb13-31"><a href="#cb13-31" tabindex="-1"></a><span class="st">## Credit</span></span>
<span id="cb13-32"><a href="#cb13-32" tabindex="-1"></a><span class="st">If you find this project to be useful in your academic work please cite the following paper:</span></span>
<span id="cb13-33"><a href="#cb13-33" tabindex="-1"></a><span class="st">&gt; [One, D. et al. Nature, 2021](https://nature.com)</span></span></code></pre>
</div>
<p>The above <code>README.md</code> file will render on <a href="https://github.com/ADACS-Australia/MAP21B-Training-BPindor/tree/cycle2" class="external-link">github</a>
as below.</p>
<figure><img src="fig/reuse/readme.png" alt="Rendered README.md on GitHub" class="figure mx-auto d-block"><div class="figcaption">Rendered README.md on GitHub</div>
</figure>
</div>
</section><section><h2 class="section-heading" id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h2>
<hr class="half-width">
<p>In this section we have made no changes to the core functionality of
our software project. Instead we have made changes that make the
software:</p>
<ul>
<li><strong>easier to use for both developers and users</strong></li>
<li>by separating the command line interface from the core
functionality;</li>
<li>
<strong>more portable</strong>
<ul>
<li>by listing dependencies in <code>requirements.txt</code> and
<code>environment.yml</code>;</li>
</ul>
</li>
<li>
<strong>easier to acknowledge and get help</strong>,
<ul>
<li>by adding version, date, authorship, and citation information;
and</li>
</ul>
</li>
<li>
<strong>more accessible</strong>,
<ul>
<li>by providing a <code>README.md</code> file.</li>
</ul>
</li>
</ul>
<p>The state of our project at the end of the second development cycle
can be seen on the cycle2 branch of our github repository: <a href="https://github.com/ADACS-Australia/MAP21B-Training-BPindor/tree/cycle2" class="external-link">here</a>.</p>
<div id="solo-activity-a-github-landing-page" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="solo-activity-a-github-landing-page" class="callout-inner">
<h3 class="callout-title">SOLO Activity: A GitHub landing page</h3>
<div class="callout-content">
<p>When people visit the GitHub page for your project they would like to
see more than just a directory listing of the files. People are
typically looking for some description of what the project is, and how
they can install and use it. In this activity we will ensure that our
project has a landing page that is attractive to potential users.</p>
<ol style="list-style-type: decimal">
<li>Use the GitHub online editor to create a new <code>LICENSE</code>
file and choose an appropriate license from the template.</li>
<li>Create or update your project’s <code>README.md</code> file so that
it contains at least:
<ol style="list-style-type: decimal">
<li>A short description of the software</li>
<li>Some basic install instructions,</li>
<li>Some basic usage instructions,</li>
<li>A note about what documentation is available,</li>
<li>A section that lists the authors/contributors to the project (and a
link to CONTRIBUTING.md if you have one).</li>
<li>A section that lets people know how you would like to receive credit
if they should use your work.</li>
</ol>
</li>
<li>Edit the “about” section of the GitHub page to include a short
description of the project and at least one topic.</li>
</ol>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-TestAndDoc"><p>Content from <a href="TestAndDoc.html">Testing and Documenting Code</a></p>
<hr>
<p>Last updated on 2026-02-25 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/TestAndDoc.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I easily document my code?</li>
<li>Why is documentation and testing even needed?</li>
<li>How do I write and run test on my code?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand why testing and documentation is important.</li>
<li>Add documentation to your project.</li>
<li>Document your work.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="documenting-via-docstrings">Documenting via docstrings<a class="anchor" aria-label="anchor" href="#documenting-via-docstrings"></a>
</h2>
<hr class="half-width">
<p>To avoid simulating the entire python interpreter in our minds, it is
often easier to document the (intended) behavior of our code in a human
readable format. Python offers the builtin function <code>help()</code>
to display the documentation for a given function. For example, if we
want to know what the <code>numpy.sum</code> function does we can just
ask:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> import <span class="ex">numpy</span> as np</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> help<span class="kw">(</span><span class="ex">np.sum</span><span class="kw">)</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="ex">Help</span> on function sum in module numpy:</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">sum</span><span class="er">(</span><span class="ex">a,</span> axis=None, dtype=None, out=None, keepdims=<span class="op">&lt;</span>no value<span class="op">&gt;</span>, initial=<span class="op">&lt;</span>no value<span class="op">&gt;</span>, where=<span class="op">&lt;</span>no value<span class="op">&gt;</span><span class="kw">)</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="ex">Sum</span> of array elements over a given axis.</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="ex">Parameters</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="ex">----------</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="ex">a</span> : array_like</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>        <span class="ex">Elements</span> to sum.</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    <span class="ex">axis</span> : None or int or tuple of ints, optional</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>        <span class="ex">Axis</span> or axes along which a sum is performed.  The default,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>        <span class="va">axis</span><span class="op">=</span>None, <span class="ex">will</span> sum all of the elements of the input array.  If</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>        <span class="ex">axis</span> is negative it counts from the last to the first axis.</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>        <span class="ex">..</span> versionadded:: 1.7.0</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    </span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        <span class="ex">If</span> axis is a tuple of ints, a sum is performed on all of the axes</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>        <span class="ex">specified</span> in the tuple instead of a single axis or all the axes as</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>        <span class="ex">before.</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>    <span class="ex">dtype</span> : dtype, optional</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>        <span class="ex">The</span> type of the returned array and of the accumulator in which the</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>        <span class="ex">elements</span> are summed.  The dtype of <span class="kw">`</span><span class="ex">a</span><span class="kw">`</span> is used by default unless <span class="kw">`</span><span class="ex">a</span><span class="kw">`</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>        <span class="ex">has</span> an integer dtype of less precision than the default platform</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>Where does <code>help()</code> get all this information from? In
part, the information provided by help is part of the docstring for the
enumerate function. We can view the docstring by viewing the
<code>__doc__</code> attribute of the function as follows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> print<span class="kw">(</span><span class="ex">np.sum.__doc__</span><span class="kw">)</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>    <span class="ex">Sum</span> of array elements over a given axis.</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>    <span class="ex">Parameters</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>    <span class="ex">----------</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="ex">a</span> : array_like</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>        <span class="ex">Elements</span> to sum.</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="ex">axis</span> : None or int or tuple of ints, optional</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>        <span class="ex">Axis</span> or axes along which a sum is performed.  The default,</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>        <span class="va">axis</span><span class="op">=</span>None, <span class="ex">will</span> sum all of the elements of the input array.  If</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>        <span class="ex">axis</span> is negative it counts from the last to the first axis.</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>        <span class="ex">..</span> versionadded:: 1.7.0</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>        <span class="ex">If</span> axis is a tuple of ints, a sum is performed on all of the axes</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>        <span class="ex">specified</span> in the tuple instead of a single axis or all the axes as</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a>        <span class="ex">before.</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="documentation-vs-commenting">Documentation vs commenting<a class="anchor" aria-label="anchor" href="#documentation-vs-commenting"></a>
</h3>
<p>There are two ways in which you can and should describe your code –
documentation and commenting. These two ways of describing code have two
audiences (which may overlap) – documentation is for the people who will
<strong>use</strong> your code, whilst comments are for people who will
<strong>develop</strong> your code. Both of these audiences include you,
the original developer, some 6 months in the future when you have
forgotten all the details about what you were doing. Quite simply:</p>
<blockquote>
<p>Documentation is a love letter that you write to your future
self.</p>
<ul>
<li>Damian Conway</li>
</ul>
</blockquote>
</div>
<div class="section level3">
<h3 id="comments">Comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>Comments should include design decisions, or explanations of
difficult to interpret code chunks. Comments can include known/expected
bugs or shortcomings in the code. Things that are not yet implemented,
or hacks that deal with bugs in other modules, should also be in
comments. Python comments come in two flavours: a single or part line
comment which begins with a #, or a multiline comment which is any
string literal.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="co">A comment that covers more than one line</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">because it is just so long</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">'''</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="kw">def</span> my_func(num):</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="co"># assume that num is some numeric type, or at the very least</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="co"># an object which supports division against an integer</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    ans <span class="op">=</span> num <span class="op">/</span> <span class="dv">2</span> <span class="co"># A partial line comment</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="cf">return</span> ans</span></code></pre>
</div>
<p>The partial-line comment plus multi-line commands can be used to
great effect when defining functions, dictionaries, or lists:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">dict</span> <span class="op">=</span> {<span class="st">'key1'</span>: <span class="dv">0</span>, <span class="co"># note about this item</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>        <span class="st">'key2'</span>: <span class="dv">1</span>, <span class="co"># another note</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>       }</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="kw">def</span> my_func(num,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>            ax, <span class="co"># a matplotlib axes object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>            verbose<span class="op">=</span><span class="va">True</span>, <span class="co"># </span><span class="al">TODO</span><span class="co"> update to be logger.isEnabledFor(logging.DEBUG)</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>            <span class="op">**</span>kwargs)</span></code></pre>
</div>
<p>When python is interpreted (or compiled to byte-code), the
interpreter will <em>ignore</em> the comments. The comments therefore
only exist in the source code. Commenting your code has no effect on the
behavior of your code, but it will (hopefully) increase your ability to
understand what you did. Because the comments are ignored by the python
interpreter only people with access to your source code will read them
(developer usually), so this is a bad place to describe how your code
should be used. For notes about code usage we instead use
documentation.</p>
</div>
<div class="section level3">
<h3 id="docstrings">Docstrings<a class="anchor" aria-label="anchor" href="#docstrings"></a>
</h3>
<p>Python provides a way for use to document the code inline, using <a href="https://www.python.org/dev/peps/pep-0257/" class="external-link">docstrings</a>.
Docstrings can be attached to functions, classes, or modules, and are
defined using a simple syntax as follows:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="kw">def</span> my_func():</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="co">"""</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">  This is the doc-string for the function my_func.</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">  I can type anything I like in here.</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">  The only constraint is that I start and end with tripe quotes (' or ")</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">  I can use multi-line strings like this, or just a single line string if I prefer.</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">  """</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="cf">return</span></span></code></pre>
</div>
<p>Docstrings can be any valid string literal, meaning that they can be
encased in either single or double quotes, but they need to be triple
quoted. Raw and Unicode strings are also fine.</p>
<p>Docstrings can be included anywhere in your code, however unless they
immediately follow the beginning of a file (for modules) or the
definition of a class or function, they will be ignored by the compiler.
The docstrings which are defined at the start of a module/class/function
will be saved to the <code>__doc__</code> attribute of that object, and
can be accessed by normal python introspection.</p>
</div>
<div class="section level3">
<h3 id="docstring-formats">Docstring formats<a class="anchor" aria-label="anchor" href="#docstring-formats"></a>
</h3>
<p>While it is possible to include any information in any format within
a docstring it is clearly better to have some consistency in the
formatting.</p>
<p>There are, unfortunately, many ‘standard’ formats for python
documentation, though they are all similarly human readable so the
difference between the formats is mostly about consistency and automated
documentation.</p>
<p>Scipy, Numpy, and astropy, all use the numpydoc format which is
particularly easy to read. We will be working with the numpydoc format
in this workshop.</p>
<p>Let’s have a look at an extensive example from the numpydoc
website.</p>
<p>“““Docstring for the example.py module.</p>
<p>Modules names should have short, all-lowercase names. The module name
may have underscores if this improves readability.</p>
<p>Every module should have a docstring at the very top of the file. The
module’s docstring may extend over multiple lines. If your docstring
does extend over multiple lines, the closing three quotation marks must
be on a line by itself, preferably preceded by a blank line.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">"""</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">from __future__ import division, absolute_import, print_function</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">import os  # standard library imports first</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># Do NOT import using *, e.g. from numpy import *</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># Import the module using</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#   import numpy</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># instead or import individual functions as needed, e.g</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#  from numpy import array, zeros</span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co"># If you prefer the use of abbreviated module names, we suggest the</span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># convention used by NumPy itself::</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">import numpy as np</span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">import matplotlib as mpl</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">import matplotlib.pyplot as plt</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co"># These abbreviated names are not to be used in docstrings; users must</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co"># be able to paste and execute docstrings after importing only the</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co"># numpy module itself, unabbreviated.</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">def foo(var1, var2, *args, long_var_name='hi', **kwargs):</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">    r"""</span>Summarize the function <span class="kw">in</span> one line.</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>    Several sentences providing an extended description. Refer to</span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>    variables using back<span class="op">-</span>ticks, e.g. `var`.</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>    Parameters</span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>    var1 : array_like</span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>        Array_like means <span class="bu">all</span> those objects <span class="op">--</span> lists, nested lists, etc. <span class="op">--</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>        that can be converted to an array.  We can also refer to</span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>        variables like `var1`.</span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>    var2 : <span class="bu">int</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>        The <span class="bu">type</span> above can either refer to an actual Python <span class="bu">type</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>        (e.g. ``int``), <span class="kw">or</span> describe the <span class="bu">type</span> of the variable <span class="kw">in</span> more</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>        detail, e.g. ``(N,) ndarray`` <span class="kw">or</span> ``array_like``.</span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>    <span class="op">*</span>args : iterable</span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>        Other arguments.</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>    long_var_name : {<span class="st">'hi'</span>, <span class="st">'ho'</span>}, optional</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>        Choices <span class="kw">in</span> brackets, default first when optional.</span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a>    <span class="op">**</span>kwargs : <span class="bu">dict</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a>        Keyword arguments.</span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a>    Returns</span>
<span id="cb6-52"><a href="#cb6-52" tabindex="-1"></a>    <span class="op">-------</span></span>
<span id="cb6-53"><a href="#cb6-53" tabindex="-1"></a>    <span class="bu">type</span></span>
<span id="cb6-54"><a href="#cb6-54" tabindex="-1"></a>        Explanation of anonymous <span class="cf">return</span> value of <span class="bu">type</span> ``type``.</span>
<span id="cb6-55"><a href="#cb6-55" tabindex="-1"></a>    describe : <span class="bu">type</span></span>
<span id="cb6-56"><a href="#cb6-56" tabindex="-1"></a>        Explanation of <span class="cf">return</span> value named `describe`.</span>
<span id="cb6-57"><a href="#cb6-57" tabindex="-1"></a>    out : <span class="bu">type</span></span>
<span id="cb6-58"><a href="#cb6-58" tabindex="-1"></a>        Explanation of `out`.</span>
<span id="cb6-59"><a href="#cb6-59" tabindex="-1"></a>    type_without_description</span>
<span id="cb6-60"><a href="#cb6-60" tabindex="-1"></a></span>
<span id="cb6-61"><a href="#cb6-61" tabindex="-1"></a>    Other Parameters</span>
<span id="cb6-62"><a href="#cb6-62" tabindex="-1"></a>    <span class="op">----------------</span></span>
<span id="cb6-63"><a href="#cb6-63" tabindex="-1"></a>    only_seldom_used_keywords : <span class="bu">type</span></span>
<span id="cb6-64"><a href="#cb6-64" tabindex="-1"></a>        Explanation.</span>
<span id="cb6-65"><a href="#cb6-65" tabindex="-1"></a>    common_parameters_listed_above : <span class="bu">type</span></span>
<span id="cb6-66"><a href="#cb6-66" tabindex="-1"></a>        Explanation.</span>
<span id="cb6-67"><a href="#cb6-67" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" tabindex="-1"></a>    Raises</span>
<span id="cb6-69"><a href="#cb6-69" tabindex="-1"></a>    <span class="op">------</span></span>
<span id="cb6-70"><a href="#cb6-70" tabindex="-1"></a>    BadException</span>
<span id="cb6-71"><a href="#cb6-71" tabindex="-1"></a>        Because you shouldn<span class="st">'t have done that.</span></span>
<span id="cb6-72"><a href="#cb6-72" tabindex="-1"></a></span>
<span id="cb6-73"><a href="#cb6-73" tabindex="-1"></a><span class="er">    See Also</span></span>
<span id="cb6-74"><a href="#cb6-74" tabindex="-1"></a>    <span class="op">--------</span></span>
<span id="cb6-75"><a href="#cb6-75" tabindex="-1"></a>    numpy.array : Relationship (optional).</span>
<span id="cb6-76"><a href="#cb6-76" tabindex="-1"></a>    numpy.ndarray : Relationship (optional), which could be fairly <span class="bu">long</span>, <span class="kw">in</span></span>
<span id="cb6-77"><a href="#cb6-77" tabindex="-1"></a>                    which case the line wraps here.</span>
<span id="cb6-78"><a href="#cb6-78" tabindex="-1"></a>    numpy.dot, numpy.linalg.norm, numpy.eye</span>
<span id="cb6-79"><a href="#cb6-79" tabindex="-1"></a></span>
<span id="cb6-80"><a href="#cb6-80" tabindex="-1"></a>    Notes</span>
<span id="cb6-81"><a href="#cb6-81" tabindex="-1"></a>    <span class="op">-----</span></span>
<span id="cb6-82"><a href="#cb6-82" tabindex="-1"></a>    Notes about the implementation algorithm (<span class="cf">if</span> needed).</span>
<span id="cb6-83"><a href="#cb6-83" tabindex="-1"></a></span>
<span id="cb6-84"><a href="#cb6-84" tabindex="-1"></a>    This can have multiple paragraphs.</span>
<span id="cb6-85"><a href="#cb6-85" tabindex="-1"></a></span>
<span id="cb6-86"><a href="#cb6-86" tabindex="-1"></a>    You may include some math:</span>
<span id="cb6-87"><a href="#cb6-87" tabindex="-1"></a></span>
<span id="cb6-88"><a href="#cb6-88" tabindex="-1"></a>    .. math:: X(e<span class="op">^</span>{j\omega } ) <span class="op">=</span> x(n)e<span class="op">^</span>{ <span class="op">-</span> j\omega n}</span>
<span id="cb6-89"><a href="#cb6-89" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" tabindex="-1"></a>    And even use a Greek symbol like :math:`\omega` inline.</span>
<span id="cb6-91"><a href="#cb6-91" tabindex="-1"></a></span>
<span id="cb6-92"><a href="#cb6-92" tabindex="-1"></a>    References</span>
<span id="cb6-93"><a href="#cb6-93" tabindex="-1"></a>    <span class="op">----------</span></span>
<span id="cb6-94"><a href="#cb6-94" tabindex="-1"></a>    Cite the relevant literature, e.g. [<span class="dv">1</span>]_.  You may also cite these</span>
<span id="cb6-95"><a href="#cb6-95" tabindex="-1"></a>    references <span class="kw">in</span> the notes section above.</span>
<span id="cb6-96"><a href="#cb6-96" tabindex="-1"></a></span>
<span id="cb6-97"><a href="#cb6-97" tabindex="-1"></a>    .. [<span class="dv">1</span>] O. McNoleg, <span class="st">"The integration of GIS, remote sensing,</span></span>
<span id="cb6-98"><a href="#cb6-98" tabindex="-1"></a><span class="er">       expert systems and adaptive co-kriging for environmental habitat</span></span>
<span id="cb6-99"><a href="#cb6-99" tabindex="-1"></a>       modelling of the Highland Haggis using <span class="bu">object</span><span class="op">-</span>oriented, fuzzy<span class="op">-</span>logic</span>
<span id="cb6-100"><a href="#cb6-100" tabindex="-1"></a>       <span class="kw">and</span> neural<span class="op">-</span>network techniques,<span class="st">" Computers &amp; Geosciences, vol. 22,</span></span>
<span id="cb6-101"><a href="#cb6-101" tabindex="-1"></a><span class="er">       pp. 585-588, 1996.</span></span>
<span id="cb6-102"><a href="#cb6-102" tabindex="-1"></a></span>
<span id="cb6-103"><a href="#cb6-103" tabindex="-1"></a>    Examples</span>
<span id="cb6-104"><a href="#cb6-104" tabindex="-1"></a>    <span class="op">--------</span></span>
<span id="cb6-105"><a href="#cb6-105" tabindex="-1"></a>    These are written <span class="kw">in</span> doctest <span class="bu">format</span>, <span class="kw">and</span> should illustrate how to</span>
<span id="cb6-106"><a href="#cb6-106" tabindex="-1"></a>    use the function.</span>
<span id="cb6-107"><a href="#cb6-107" tabindex="-1"></a></span>
<span id="cb6-108"><a href="#cb6-108" tabindex="-1"></a>    <span class="op">&gt;&gt;&gt;</span> a <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb6-109"><a href="#cb6-109" tabindex="-1"></a>    <span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>([x <span class="op">+</span> <span class="dv">3</span> <span class="cf">for</span> x <span class="kw">in</span> a])</span>
<span id="cb6-110"><a href="#cb6-110" tabindex="-1"></a>    [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb6-111"><a href="#cb6-111" tabindex="-1"></a>    <span class="op">&gt;&gt;&gt;</span> <span class="bu">print</span>(<span class="st">"a</span><span class="ch">\n</span><span class="st">b"</span>)</span>
<span id="cb6-112"><a href="#cb6-112" tabindex="-1"></a>    a</span>
<span id="cb6-113"><a href="#cb6-113" tabindex="-1"></a>    b</span>
<span id="cb6-114"><a href="#cb6-114" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb6-115"><a href="#cb6-115" tabindex="-1"></a><span class="co">    # After closing class docstring, there should be one blank line to</span></span>
<span id="cb6-116"><a href="#cb6-116" tabindex="-1"></a><span class="co">    # separate following codes (according to PEP257).</span></span>
<span id="cb6-117"><a href="#cb6-117" tabindex="-1"></a><span class="co">    # But for function, method and module, there should be no blank lines</span></span>
<span id="cb6-118"><a href="#cb6-118" tabindex="-1"></a><span class="co">    # after closing the docstring.</span></span>
<span id="cb6-119"><a href="#cb6-119" tabindex="-1"></a><span class="co">    pass</span></span></code></pre>
</div>
<p>The example above is intentionally extensive, but you should be able
to see what is going on. There are a few parts to the documentation
format, some of which are considered essential, good practice, or
optional. See the numpy doc guide for a more gentle yet more complete
discussion on the <a href="https://numpydoc.readthedocs.io/en/latest/format.html#docstring-standard" class="external-link">numpydoc
standard</a>.</p>
</div>
<div class="section level3">
<h3 id="good-practice-documentation">Good practice documentation<a class="anchor" aria-label="anchor" href="#good-practice-documentation"></a>
</h3>
<p>The main goal of documentation is to describe the desired behavior or
intended use of the code. As such every docstring should contain at
least a one line statement that shows the intent of the code.</p>
<p>It is good practice to describe the expected input and output (or
behavior) of your functions.</p>
<p>In the numpydoc format we put these into two sections:</p>
<p><strong>Parameters</strong>: for the input <strong>Returns</strong>:
for the output</p>
<p>There is no “Modifies” section for the documentation (though you
could add one if you like). If the function modifies an input but does
not return the modified version as an output then this should be
included as part of the long form description.</p>
<p>The <code>generate_positions</code> function from the example
<code>skysim</code> module has the following docstring:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> generate_positions(ref_ra<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                       ref_dec<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                       radius<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>                       nsources<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">    Create nsources random locations within radius of the reference position.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">    Parameters</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">    ----------</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co">    ref_ra, ref_dec : str</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co">        Reference position in "HH:MM:SS.S"/"DD:MM:SS.S" format.</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="co">        Default position is Andromeda galaxy.</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co">    radius : float</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co">        The radius within which to generate positions. Default = 1.</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="co">    nsources : int</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">        The number of positions to generate</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a><span class="co">    ra, dec : numpy.array</span></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">        Arrays of ra and dec coordinates in degrees.</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="co">    """</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="optional-documentation">Optional documentation<a class="anchor" aria-label="anchor" href="#optional-documentation"></a>
</h3>
<p>The type of errors that are raised, and under what conditions, can be
documented in the <code>Raises</code> section.</p>
<p><code>Notes</code>, <code>References</code>, and
<code>Examples</code>, are also useful sections but not usually
applicable to all functions or classes that you will be writing. If I
have used code snippets from stack-overflow or similar, then I find
Notes/References section to be a good place to acknowledge and link to
those resources.</p>
<p>The Examples section can be used to show intended use. There is an
automated testing suite called doctest which will scan your docstrings
looking for segments starting with &gt;&gt;&gt; and then run those
segments in an interactive python interpreter. A solid test suite will
typically contain many tests for a single function, thus trying to embed
all the tests into your docstrings just makes for very long docstrings.
It is preferable to keep your testing code in the <code>tests</code>
module/directory of your python module, and to use the
<code>Examples</code> section only for demonstrating functionality to
the end user.</p>
</div>
<div class="section level3">
<h3 id="making-use-of-documentation">Making use of documentation<a class="anchor" aria-label="anchor" href="#making-use-of-documentation"></a>
</h3>
<p>Some IDEs (the good ones) provide syntax highlighting, linting, and
inline help as you write code. By providing docstrings for all your
functions you can make use of the linting and inline help. Below is an
example from <a href="https://code.visualstudio.com/" class="external-link">VSCode</a> in
which the docstring for a function is being shown:</p>
<figure><img src="fig/test/vscode-hints.png" alt="Help text being used as hint text in VSCode" class="figure mx-auto d-block"><div class="figcaption">Help text being used as hint text in
VSCode</div>
</figure><p>You can use the help from the python console like this:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> from <span class="ex">skysim</span> import sim</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> help<span class="kw">(</span><span class="ex">sim.generate_positions</span><span class="kw">)</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="ex">Help</span> on function generate_positions in module skysim.sim:</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="ex">generate_positions</span><span class="er">(</span><span class="va">ref_ra</span><span class="op">=</span><span class="st">'00:42:44.3'</span>, <span class="va">ref_dec</span><span class="op">=</span><span class="st">'41:16:09'</span>, <span class="va">radius</span><span class="op">=</span>1.0, <span class="va">nsources</span><span class="op">=</span>1000<span class="kw">)</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="ex">Create</span> nsources random locations within radius of the reference position.</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>    </span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    <span class="ex">Parameters</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>    <span class="ex">----------</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>    <span class="ex">ref_ra,</span> ref_dec : str</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>        <span class="ex">Reference</span> position in <span class="st">"HH:MM:SS.S"</span>/<span class="st">"DD:MM:SS.S"</span> format.</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>        <span class="ex">Default</span> position is Andromeda galaxy.</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>    </span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a>    <span class="ex">radius</span> : float</span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>        <span class="ex">The</span> radius within which to generate positions. Default = 1.</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>    </span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a>    <span class="ex">nsources</span> : int</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>        <span class="ex">The</span> number of positions to generate</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>    </span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a>    <span class="ex">Returns</span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a>    <span class="ex">-------</span></span>
<span id="cb8-23"><a href="#cb8-23" tabindex="-1"></a>    <span class="ex">ra,</span> dec : numpy.array</span>
<span id="cb8-24"><a href="#cb8-24" tabindex="-1"></a>        <span class="ex">Arrays</span> of ra and dec coordinates in degrees.</span>
<span id="cb8-25"><a href="#cb8-25" tabindex="-1"></a><span class="ex">...</span></span></code></pre>
</div>
<p>Additionally you can compile all the documentation into a website or
other document using an automated documentation tool as described in the
next section.</p>
</div>
<div class="section level3">
<h3 id="automated-documentation">Automated Documentation<a class="anchor" aria-label="anchor" href="#automated-documentation"></a>
</h3>
<p>If your docstrings are formatted in a regular way then you can make
use of an automated documentation tool. There are many such tools
available with a range of sophistication.</p>
<p>The simplest to use is the <code>pdoc</code> package which can be
obtained from pypi.org. The packaged can be installed via
<code>pip install pdoc</code>, and then run on our test module using
<code>pdoc skysim</code>.</p>
<p>By default <code>pdoc</code> will start a mini web sever with the
documentation on it. This should be opened in your browser by default
but if it isn’t you can navigate to <code>localhost:8080</code> or
<code>127.0.0.1:8080</code>. Use <code>&lt;ctrl&gt;+C</code> when you
want to stop the web server. For the example project this is the website
that is generated:</p>
<figure><img src="fig//test/pandoc-minibrowser.png" alt="Documentation rendered by pandoc for the skysim.sim module" class="figure mx-auto d-block"><div class="figcaption">Documentation rendered by pandoc for the
skysim.sim module</div>
</figure><p>To make documentation that is less ephemeral you can use the the
<code>-d docs</code> option to cause all the documentation to be built
and then placed into the <code>docs</code> folder. <code>pdoc</code>
only supports html output, however other auto-documentation packages
such as <a href="https://www.sphinx-doc.org/en/master/" class="external-link">sphinx</a> can
write latex (and thus pdf), ePub, man pages, or plain text.</p>
</div>
<div class="section level3">
<h3 id="other-forms-of-documentation">Other forms of documentation<a class="anchor" aria-label="anchor" href="#other-forms-of-documentation"></a>
</h3>
<p>Compiling all your docstrings into an easy to find and navigate
website is great, but this typically does not do a good job of
documenting your software project as a whole. What is required here is
something that deals with the intent of the software, a description of
the problem that it is solving, and how users can install and begin to
use the software. For this you have a few options:</p>
<ul>
<li>a <code>README.md</code> in your repository</li>
<li>a user guide document (html or PDF)</li>
<li>a wiki or <a href="https://www.readthedocs.org/" class="external-link">rtfd.io</a> style
website</li>
</ul>
<p>Within any of the above you would want to include things such as:</p>
<ul>
<li>a guide for downloading/compiling/installing your software</li>
<li>a ‘quick-start’ guide or set of examples for new users</li>
<li>a Frequently Asked Questions (FAQ) section to address common
problems</li>
<li>tutorials to demonstrate some of the key features of your software
(Jupyter notebooks are great here)</li>
</ul>
<p>GitHub and GitLab both provide a wiki for each project. Additionally
both platforms will allow you to set up Continuous Integration (CI)
tools that will automatically build and publish your documentation to a
third party website.</p>
</div>
<div class="section level3">
<h3 id="documentation-as-part-of-your-development-cycle">Documentation as part of your development cycle<a class="anchor" aria-label="anchor" href="#documentation-as-part-of-your-development-cycle"></a>
</h3>
<p>A typical development cycle will consist of writing code, testing
code, and writing documentation. The order in which this is done depends
on the software development strategies that you set out for your
project, or simply personal preference. At the end of the day the
process is cyclic – with the end goal of having code, tests, and
documentation that are all in agreement. Once your
code/tests/documentation are consistent then you can package your code
into a module and publish it for others to use.</p>
</div>
</section><section><h2 class="section-heading" id="generating-documentation-with-sphinx">Generating documentation with sphinx<a class="anchor" aria-label="anchor" href="#generating-documentation-with-sphinx"></a>
</h2>
<hr class="half-width">
<p>The <code>pdoc</code> module that we used in the last lesson was
nice, but more sophisticated options are available. Many of the
documentation pages that you may have viewed (such as <a href="https://scipy.org/docs.html" class="external-link">scipy</a>, <a href="https://numpy.org/doc/stable/" class="external-link">numpy</a>, or <a href="https://docs.astropy.org/en/stable/" class="external-link">astropy</a>), use the <a href="https://www.sphinx-doc.org/en/master/" class="external-link">Sphinx</a> python
documentation generator. Not only will Sphinx generate documentation
from your docstrings, but it will also allow you to write documentation
in <a href="https://docutils.sourceforge.io/rst.html" class="external-link">reStructuredText</a>
which can then be rendered into HTML, PDF, ePub, and other document
formats. For publishing code to a website such as <a href="https://readthedocs.org/" class="external-link">readthedocs</a>, Sphinx is an essential
choice.</p>
<div class="section level3">
<h3 id="creating-documentation-from-our-docstrings">Creating documentation from our docstrings<a class="anchor" aria-label="anchor" href="#creating-documentation-from-our-docstrings"></a>
</h3>
<p>The documentation work that we have done on the test module will not
be wasted. Sphinx understands a range of documentation styles and can
fairly reliably auto-detect which one you are using (even if you change
throughout your project!).</p>
<p>To begin using Sphinx we need to install it via pip. It is
recommended that we use a dedicated directory for our documentation
(<code>docs/</code>). Once Sphinx is installed we initialise our
documetaion using the <code>sphinx-quickstart</code> command.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-U</span> sphinx</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">mkdir</span> docs</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="bu">cd</span> docs</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="ex">sphinx-quickstart</span></span></code></pre>
</div>
<p>We’ll be taken through a sort of install wizard with a few questions
as follows. (bold are the answers that have been used for the example
project).</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Welcome to the Sphinx 4.3.1 quickstart utility.

Please enter values for the following settings (just press Enter to
accept a default value, if one is given in brackets).

Selected root path: .

You have two options for placing the build directory for Sphinx output.
Either, you use a directory "_build" within the root path, or you separate
"source" and "build" directories within the root path.
&gt; Separate source and build directories (y/n) [n]: y

The project name will occur in several places in the built documentation.
&gt; Project name: SkySim
&gt; Author name(s): Dev One
&gt; Project release []: v3.0

If the documents are to be written in a language other than English,
you can select a language here by its language code. Sphinx will then
translate text that it generates into that language.

For a list of supported codes, see
https://www.sphinx-doc.org/en/master/usage/configuration.html#confval-language.
&gt; Project language [en]:

Creating file /data/alpha/hancock/ADACS/MAP21B-Training-BPindor/docs/source/conf.py.
Creating file /data/alpha/hancock/ADACS/MAP21B-Training-BPindor/docs/source/index.rst.
Creating file /data/alpha/hancock/ADACS/MAP21B-Training-BPindor/docs/Makefile.
Creating file /data/alpha/hancock/ADACS/MAP21B-Training-BPindor/docs/make.bat.

Finished: An initial directory structure has been created.

You should now populate your master file /data/alpha/hancock/ADACS/MAP21B-Training-BPindor/docs/source/index.rst and create other documentation
source files. Use the Makefile to build the docs, like so:
   make builder
where "builder" is one of the supported builders, e.g. html, latex or linkcheck.</code></pre>
</div>
<p>For most of these questions you can choose whatever answers you like,
however separating the build/source directories for your documentation
is recommended. Separate build/source directories make it easier to keep
the documentation source under version control.</p>
<p>The setup will create the following file structure:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>docs/
├── build
├── make.bat
├── Makefile
└── source
    ├── conf.py
    ├── index.rst
    ├── _static
    └── _templates</code></pre>
</div>
<p>If we move into the <code>docs/</code> directory and type
<code>make html</code> Sphinx will generate some documentation for us.
The documentation will be a set of static <code>.html</code> files in
the <code>build/</code> directory. Open
<code>docs/build/index.html</code> in your web browser to view them. At
the moment there is no content, just a few links to empty or broken
pages.</p>
<p>The reason that the website is empty is because we have a very spare
<code>docs/source/</code> directory. What we are seeing is simply the
result of the <code>index.rst</code> page being rendered. In order to
extract the docstrings from our module, and build the html documentation
we have to edit some of the sphinx settings.</p>
<p>In the file <code>socs/source/conf.py</code> there are a lot of
options that are set to default values. The answers that you chose in
the initialisation stage are also in this file in case you need to
change them (for example the release number).</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Add any Sphinx extension module names here, as strings. They can be</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># extensions coming with Sphinx (named 'sphinx.ext.*') or your custom</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co"># ones.</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>extensions <span class="op">=</span> [<span class="st">'sphinx.ext.autodoc'</span>,</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>              <span class="st">'sphinx.ext.mathjax'</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>              <span class="st">'sphinx.ext.viewcode'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>              <span class="st">'sphinx.ext.napoleon'</span>,</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>             ]</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>...</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>html_theme <span class="op">=</span> <span class="st">'sphinx_rtd_theme'</span></span></code></pre>
</div>
<p>The extensions setting enables different sphinx extensions. See the
<a href="https://www.sphinx-doc.org/en/master/usage/extensions/index.html" class="external-link">sphinx
extensions</a> page for a list of what modules are available and what
they do. The <code>html_theme</code> sets the theme for the website.
Here we have chosen the <code>sphinx_rtd_theme</code> which renders the
page using the default read the docs theme. If you want to explore more
themes then you should visit the sphinx-themes gallery.</p>
<p>Some of the sphinx extensions (including the theme chosen here)
require additional modules to be installed. Normally we would put these
required modules in the <code>requirements.txt</code> file for our
project. However, the documentation is typically only going to be built
by developers (and automation scripts) and not end users, so instead we
create a new file <code>docs/requirements.txt</code> that will list all
the dependencies for building the documentation. Note that the theme
<code>sphinx_rtd_theme</code> is provided by the
<code>sphinx-rtd-theme</code> module (replacing <code>_</code> with
<code>-</code>).</p>
<p>Now that we have the <code>autodoc</code> extension enabeled, we just
need to update the website to include this feature. In the
<code>docs/source/index.rst</code> file we can add the following:</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Modules
=======

.. automodule:: skysim.sim
   :members:</code></pre>
</div>
<p>With the extra extensions installed and the index updated we can now
run <code>make html</code> again and see the updated documentation web
pages.</p>
<figure><img src="fig/test/Sphinx-docs.png" alt="Documentation made with sphinx" class="figure mx-auto d-block"><div class="figcaption">Documentation made with sphinx</div>
</figure><p>We now have a way of turning all our module/class/function docstrings
into documentation.</p>
<p>At this point we have generated documentation that would be useful to
people who are either developing this module, or who are importing it
for use in their own software. Essentially we are just documenting the
API for this software.</p>
</div>
<div class="section level3">
<h3 id="cross-linking-your-docstrings">Cross-linking your docstrings<a class="anchor" aria-label="anchor" href="#cross-linking-your-docstrings"></a>
</h3>
<p>Sphinx provides a mechanism that will allow you to make links between
different parts of your documentation. Two main uses for this are for
your “see also” section, where you would link to similar
functions/modules, or in your parameter descriptions where you want to
say that a parameter is some custom object type.</p>
<p>To make these links you simply use back-tics around the
module/function/class you want to reference. Note that in our
documentation for <code>skysim.sim.generate_positions</code> we indicate
that the ra/dec return variables are of type <code>numpy.array</code>.
At the moment this is treated as just a string, however we can link it
to the numpy documentation by using the extension called
<code>intersphinx</code>.</p>
<p>To enable <code>intersphinx</code> we update the extensions part of
the <code>conf.py</code> file, and then add a new parameter called
<code>intersphinx_mapping</code> as shown below.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Add any Sphinx extension module names here, as strings. They can be</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># extensions coming with Sphinx (named 'sphinx.ext.*') or your custom</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># ones.</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>extensions <span class="op">=</span> [<span class="st">'sphinx.ext.autodoc'</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>              <span class="st">'sphinx.ext.mathjax'</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>              <span class="st">'sphinx.ext.viewcode'</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>              <span class="st">'sphinx.ext.napoleon'</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>              <span class="st">'sphinx.ext.intersphinx'</span>,</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>              ]</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co"># Add mappings</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>intersphinx_mapping <span class="op">=</span> {</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>   <span class="st">'numpy'</span>: (<span class="st">'https://numpy.org/doc/stable'</span>, <span class="va">None</span>),</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>   <span class="st">'python'</span>: (<span class="st">'http://docs.python.org/3'</span>, <span class="va">None</span>),</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>}</span></code></pre>
</div>
<p>To make links we use back-tics around the module/function/class you
want to reference:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="kw">def</span> generate_positions(ref_ra<span class="op">=</span><span class="st">'00:42:44.3'</span>,</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                       ref_dec<span class="op">=</span><span class="st">'41:16:09'</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                       radius<span class="op">=</span><span class="fl">1.</span>,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>                       nsources<span class="op">=</span><span class="dv">1000</span>):</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">    Returns</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">    -------</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">    ra, dec : :obj:`numpy.array`</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">        Arrays of ra and dec coordinates in degrees.</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">    """</span></span></code></pre>
</div>
<p>We can also link to other functions/classes within our module using
<code>:func:`skysim.sim.generate_positions`</code>.</p>
</div>
<div class="section level3">
<h3 id="creating-additional-documentation">Creating additional documentation<a class="anchor" aria-label="anchor" href="#creating-additional-documentation"></a>
</h3>
<p>By default Sphinx can render any document that is in <a href="https://docutils.sourceforge.io/rst.html" class="external-link">reStructuredText</a>
format. In the <code>docs/source</code> directory you’ll see a file
<code>index.rst</code> which has been auto-generated by Sphinx. This
file will contain some content and directives for generating
content.</p>
<p>Initially the table of contents is empty and not shown on the main
page, and the left pane just shows the section headers for the current
page. The content on the main page has been generated from all the
docstrings in your module(s). In order to include additional
documentation you can add your own content pages and link to them from
here.</p>
<p>Create a new file called <code>docs/source/example.rst</code>, and
then add some content. Save the file. Now edit the
<code>docs/source/index.rst</code> to link to this page by making the
following change (last line):</p>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Welcome to MyProject's documentation!
=====================================

.. toctree::
   :maxdepth: 2
   :caption: Contents:

   example</code></pre>
</div>
<p>You can now build an entire website using this strategy. You can link
to pages using <code>:ref:`page_name`</code>, where
<code>page_name</code> is the name of the file/page.</p>
</div>
<div class="section level3">
<h3 id="using-markdown">Using markdown<a class="anchor" aria-label="anchor" href="#using-markdown"></a>
</h3>
<p>If you don’t like rst, and would prefer markdown you can write
markdown for your custom pages. This is particularly useful if you
already have pages in markdown format (e.g. from an existing wiki).</p>
<p>The extension to use is a third party extension called
<code>myst_parser</code>. We can install it with
<code>pip install myst-parser</code>, and then enable it in the
<code>conf.py</code> as follows:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Add any Sphinx extension module names here, as strings. They can be</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="co"># extensions coming with Sphinx (named 'sphinx.ext.*') or your custom</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co"># ones.</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>extensions <span class="op">=</span> [<span class="st">'sphinx.ext.autodoc'</span>,</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>              <span class="st">'sphinx.ext.mathjax'</span>,</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>              <span class="st">'sphinx.ext.viewcode'</span>,</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>              <span class="st">'sphinx.ext.napoleon'</span>,</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>              <span class="st">'sphinx.ext.intersphinx'</span>,</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>              <span class="st">'myst_parser'</span>,</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>              ]</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co"># mappings for parsing files</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>source_suffix <span class="op">=</span> {<span class="st">'.rst'</span>:<span class="st">'restructuredtext'</span>,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>                 <span class="st">'.md'</span>:<span class="st">'markdown'</span>}</span></code></pre>
</div>
<p>The source_suffix provides sphinx with a way to determine what format
to use when parsing the different file types.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>You should now be able to create documentation from the docstrings of
your module, and from additional <code>.rst</code> or <code>.md</code>
files that provide more of a user guide style.</p>
<p>Once you have a set of documentation that you are happy with, you can
host them at readthedocs.org. See the tutorial for instructions on how
to do this. <!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 --></p>
</div>
</section></section><section id="aio-AutomationAndCI"><p>Content from <a href="AutomationAndCI.html">Automation and Continuous Integration (on GitHub)</a></p>
<hr>
<p>Last updated on 2026-02-26 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/AutomationAndCI.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is CI?</li>
<li>How can I use GitHub to test my code?</li>
<li>How do automatically build documentation?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Become familiar with GitHub actions</li>
<li>Use a github action to test your code</li>
<li>Use a github action to build documentation</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="using-github-to-run-your-tests">Using GitHub to run your tests<a class="anchor" aria-label="anchor" href="#using-github-to-run-your-tests"></a>
</h2>
<hr class="half-width">
<p>In this lesson we’ll learn how to have all our tests run every time
we push changes to GitHub. This is an example of a continuous
integration (CI) workflow. CI workflows are available via third party
services such as <a href="https://app.travis-ci.com/" class="external-link">Travis-CI</a>,
which you can link to your GitHub, GitLab, or Bitbucket repositories to
build, test, and report on your projects. For this lesson we’ll use
GitHub actions to perform the testing.</p>
<div class="section level3">
<h3 id="github-actions">GitHub actions<a class="anchor" aria-label="anchor" href="#github-actions"></a>
</h3>
<blockquote>
<p>GitHub Actions makes it easy to automate all your software workflows,
now with world-class CI/CD. Build, test, and deploy your code right from
GitHub. Make code reviews, branch management, and issue triaging work
the way you want. GitHub.com</p>
</blockquote>
<p>GitHub actions can perform a large variety of automation of tasks,
but for this lesson we will focus only on the ability to install our
module and run the tests. All of the actions that are associated with
your project are stored in text files within your project. This means
that you can edit the actions locally and then push them like any other
file.</p>
<p>The actions are stored in a special directory called
<code>./github/workflows/</code>, and the files are stored in the
<code>.yml</code> format.</p>
</div>
<div class="section level3">
<h3 id="creating-a-new-action">Creating a new action<a class="anchor" aria-label="anchor" href="#creating-a-new-action"></a>
</h3>
<p>To create a new action the easiest way is to use the Actions tab of
your GitHub repo, and select the <code>New Workflow</code> button.</p>
<figure><img src="fig/automation/new-workflow.jpg" alt="The new workflow button on the actions page of your github repository" class="figure mx-auto d-block"><div class="figcaption">The new workflow button on the actions page of
your github repository</div>
</figure><p>The <code>New workflow</code> button will take you to a page to
choose a template from a long list. This list is semi-smart in that it
will look at the files that you have in your repository and suggest a
templates based on the language(s) that you are using. The first
template that shows up for our example repository is “<strong>Python
Package using Anaconda</strong>” which sounds like what we want so we’ll
start with that. Note that you can “set up a workflow yourself” using
the small link (this will begin with a blank workflow). Also note that
the templates are hosted in GitHub repositories so that you can browse
them and copy ideas from one to another. For the “<strong>Python Package
using Anaconda</strong>” the template is in the
<code>actions/starter-workflows</code> repository.</p>
<figure><img src="fig/automation/workflow-templates.png" alt="Python workflow templates available on Github" class="figure mx-auto d-block"><div class="figcaption">Python workflow templates available on
Github</div>
</figure><p>After selecting a template we’ll go to the online editor for
committing a new file on GitHub. The file
(<code>./github/workflows/python-package-conda.yml</code>) is currently
as follows:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Python Package using Conda</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">push</span><span class="kw">]</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="at">  </span><span class="fu">build-linux</span><span class="kw">:</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="at">    </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="at">      </span><span class="fu">max-parallel</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python 3.10</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v2</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.10</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Add conda to system path</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>        # $CONDA is an environment variable pointing to the root of the miniconda directory</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>        echo $CONDA/bin &gt;&gt; $GITHUB_PATH</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>        conda env update --file environment.yml --name base</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Lint with flake8</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>        conda install flake8</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>        # stop the build if there are Python syntax errors or undefined names</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>        flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>        # exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>        flake8 . --count --exit-zero --max-complexity=10 --max-line-length=127 --statistics</span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Test with pytest</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>        conda install pytest</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>        pytest</span></code></pre>
</div>
<p>The first two lines give the <code>name</code> of the action which is
just for your own reference, and an <code>on</code> directive. The
<code>on</code> directive will trigger this action when
<code>[push]</code> happens. This is what we want.</p>
<p>The main part of the action is the <code>jobs:</code> section, which
can specify multiple jobs. Currently there is just one job with the name
<code>build-linux</code>. Within this job there are multiple
<code>steps</code> that are run.</p>
<p>The template is mostly good however:</p>
<ul>
<li>since this is the Anaconda template it uses conda for all the
build/test. However Anaconda is slow to create new environments and
install software;</li>
<li>there is a bug in this template: the <code>python-version</code>
should be a string, not a float;</li>
<li>we don’t want to run the lint step.</li>
</ul>
<p>We will replace conda with pip and can fix the other issues by
updating the script to be as follows:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Build and Test Python package using pip</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">push</span><span class="kw">]</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="at">  </span><span class="fu">build-linux</span><span class="kw">:</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="at">    </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="at">      </span><span class="fu">max-parallel</span><span class="kw">:</span><span class="at"> </span><span class="dv">5</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Set up Python "3.6"</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="at">      </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-python@v2</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="at">      </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="at">        </span><span class="fu">python-version</span><span class="kw">:</span><span class="at"> </span><span class="st">"3.6"</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>        # upgrade pip</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>        python -m pip install --upgrade pip</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>        # install the testing requirements</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>        python -m pip install pytest pytest-cov</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>        # install the dependencies for this</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>        pip install -r requirements.txt</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install module</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>        python -m pip install -e .</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Test with pytest</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="fu">      run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>        pytest --cov=skysim --cov-report=term</span></code></pre>
</div>
<p>Since we are now not using conda we should also change the name of
the script to be
<code>./github/workflows/python-build-test-pip.yml</code> before we save
it. Once we have made these changes and are happy we can press the green
“Start commit” button where we’ll be asked for a commit message, and
whether we want to commit to the <code>main</code> branch or to a new
branch. Lets commit directly to the <code>main</code> branch.</p>
<p>Once we make the commit the action will run. This is because
adding/changing a file via the GitHub webpage is considered the same as
a <code>push</code> action, which will trigger our workflow.</p>
</div>
<div class="section level3">
<h3 id="viewing-the-progressresult-of-an-action">Viewing the progress/result of an action<a class="anchor" aria-label="anchor" href="#viewing-the-progressresult-of-an-action"></a>
</h3>
<p>To see what actions have been run and why, we navigate to the
“Actions” tab. Here you’ll see all the actions that have ever been
triggered for your repository, how they were triggered, what the status
is, how long it took to run, and what artifacts (if any) were produced.
Below is an example showing the completed action that we just created
above.</p>
<figure><img src="fig/automation/workflow-progress.png" alt="A completed workflow on the actions page" class="figure mx-auto d-block"><div class="figcaption">A completed workflow on the actions page</div>
</figure><p>On the left, we see all the jobs that were part of this action, and
on the right we have a summary for each. We want to see green ticks as
this means that everything is ok. A red X will mean there was a problem
somewhere. Either way we can click on one of the jobs to see the
different steps of the job, and clicking the “&gt;” next to a step will
show all the details of that step. Below we can see the output of the
“test with pytest” step.</p>
<figure><img src="fig/automation/workflow-details.png" alt="Details of the workflow" class="figure mx-auto d-block"><div class="figcaption">Details of the workflow</div>
</figure><p>If an action fails then the repository owner, and anyone watching the
repository, will get a notification of the failure. When the action
succeeds for the first time after a failure a notification will be sent,
but if the action is a success following a success no further
notifications will be sent. This means that you can push changes to your
repo and you wont be bothered unless there is a problem.</p>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>We have seen how to setup a basic install-test workflow for a python
project using a GitHub action. Once you have a working action you can
extend it, create additional actions, or change how it triggers. See the
<a href="https://docs.github.com/en/actions" class="external-link">documentation</a> for more
details and some examples.</p>
</div>
</section><section><h2 class="section-heading" id="using-github-to-compile-your-documentation">Using GitHub to compile your documentation<a class="anchor" aria-label="anchor" href="#using-github-to-compile-your-documentation"></a>
</h2>
<hr class="half-width">
<p>In the previous lesson we learned how to use GitHub actions to build
and test our python module. In this lesson we’ll learn how to compile
our documentation with another GitHub action.</p>
<div class="section level3">
<h3 id="creating-a-new-workflow">Creating a new workflow<a class="anchor" aria-label="anchor" href="#creating-a-new-workflow"></a>
</h3>
<p>To create a new action the easiest way is to use the
<code>Actions</code> tab of your GitHub repo, and select the
<code>New Workflow</code> button.</p>
<p><img src="fig/automation/new-workflow.jpg" alt="The new workflow button on the actions page of your github repository" class="figure">
￼ The <code>New workflow</code> button will take you to a page to choose
a template from a long list. Last time we started with a pre-made
template for building and testing python code. This time we are going to
start with a generic template so we should click on the “set up a
workflow yourself -&gt;” link.</p>
<p>We should see the following template appear under the file name of
<code>.github/workflows/main.yml</code>:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># This is a basic workflow to help you get started with Actions</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> CI</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co"># Controls when the workflow will run</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">  # Triggers the workflow on push or pull request events but only for the main branch</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">  # Allows you to run this workflow manually from the Actions tab</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">  # This workflow contains a single job called "build"</span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="at">  </span><span class="fu">build</span><span class="kw">:</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="co">    # The type of runner that the job will run on</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a><span class="co">    # Steps represent a sequence of tasks that will be executed as part of the job</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="co">      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="co">      # Runs a single command using the runners shell</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run a one-line script</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> echo Hello, world!</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="co">      # Runs a set of commands using the runners shell</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run a multi-line script</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="fu">        run</span><span class="kw">: </span><span class="ch">|</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a>          echo Add other actions to build,</span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a>          echo test, and deploy your project.</span></code></pre>
</div>
<p>First up we should change the filename to something other than
<code>main.yml</code> and the name field to something other than
<code>CI</code>. The section that controls when the workflow is run is
maybe a little over-zealous but we can leave it for now. Finally, the
first step which uses <code>actions/checkout@v2</code> is always useful
as it will check out our repository into the build environment. The
named steps after this are not currently useful so we should delete
them. We’ll replace these with a new step which does the documentation
build for us.</p>
</div>
<div class="section level3">
<h3 id="using-a-template-from-the-market-place">Using a template from the market place<a class="anchor" aria-label="anchor" href="#using-a-template-from-the-market-place"></a>
</h3>
<p>Since we want to build our documentation using Sphinx, we can find a
ready made solution in the GitHub marketplace. On the right panel we
select the marketplace and search for Sphinx. The first result “Sphinx
Build” looks like it does what we want so we’ll select that.</p>
<p><img src="fig/automation/workflow-sphinx.png" alt="Choosing the sphinx build workflow from the marketplace" class="figure"> ￼ When
we click the “Sphinx Build” result we get the following snippet of code.
Which we can include in our workflow file.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Sphinx Build</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">  # You may pin to the exact commit or the version.</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">  # uses: ammaraskar/sphinx-action@8b4f60114d7fd1faeba1a712269168508d4750d2</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="at">  </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> ammaraskar/sphinx-action@0.4</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="at">  </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">    # The folder containing your sphinx docs.</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="at">    </span><span class="fu">docs-folder</span><span class="kw">:</span><span class="co"> # default is docs/</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">    # The command used to build your documentation.</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="at">    </span><span class="fu">build-command</span><span class="kw">:</span><span class="co"> # optional, default is make html</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">    # Run before the build command, you can use this to install system level dependencies, for example with "apt-get update -y &amp;&amp; apt-get install -y perl"</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="at">    </span><span class="fu">pre-build-command</span><span class="kw">:</span><span class="co"> # optional</span></span></code></pre>
</div>
<p>To use the above template we make a new step called “Sphinx Build”
and copy the template into that step. As we do this we need to fill in
values for <code>docs-folder</code> and <code>build-command</code>. The
<code>pre-build-command</code> is optional and we wont use it so we can
either delete it or comment it out. Our step section now looks like
this:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">    # Steps represent a sequence of tasks that will be executed as part of the job</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Sphinx Build</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">        # You may pin to the exact commit or the version.</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> ammaraskar/sphinx-action@0.4</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">          # The folder containing your sphinx docs.</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="at">          </span><span class="fu">docs-folder</span><span class="kw">:</span><span class="at"> docs/</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">          # The command used to build your documentation.</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="at">          </span><span class="fu">build-command</span><span class="kw">:</span><span class="at"> make html</span></span></code></pre>
</div>
<p>If we commit this file it will trigger all our <code>on:push</code>
workflows to trigger – both the build/test workflow that we created
earlier, and this documentation workflow. For my example I used the name
“Documentation with Sphinx” for the workflow, and when it completes I
see the following output.</p>
<p><img src="fig/automation/workflow-docs-successful.png" alt="Successfully run documentation workflow" class="figure"> ￼ The good news is that
the documentation built without error. The bad news is that I can’t see
the documentation to ensure that it’s actually useful. Note in the above
image that there are three notes following our job: Status, Total
duration, and Artifacts. Artifacts are files that are retained after a
job completes. By default there are no artifacts, but we could modify
our workflow so that the documentation is part of the artifacts.</p>
</div>
<div class="section level3">
<h3 id="saving-the-documentation">Saving the documentation<a class="anchor" aria-label="anchor" href="#saving-the-documentation"></a>
</h3>
<p>To save the documentation that was built we need to let the GitHub
workflow know that the documentation should be considered an artefact of
the build. The advanced guide for GitHub actions demonstrates how to do
this using another pre-made recipe which is as follows:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">'Upload Artifact'</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="at">    </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v2</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="at">    </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> my-artifact</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="at">      </span><span class="fu">path</span><span class="kw">:</span><span class="at"> my_file.txt</span></span></code></pre>
</div>
<p>For us we want the artifact to be a directory docs/build/ and we’ll
give it a name of documentation-html.</p>
<p>Our full workflow for this lesson now looks like this:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">YML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yml" tabindex="0"><code class="sourceCode yaml"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># This is a basic workflow to help you get started with Actions</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Build Documentation with Sphinx</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co"># Controls when the workflow will run</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">  # Triggers the workflow on push or pull request events but only for the main branch</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> main </span><span class="kw">]</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="co">  # Allows you to run this workflow manually from the Actions tab</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="at">  </span><span class="fu">workflow_dispatch</span><span class="kw">:</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a><span class="co"># A workflow run is made up of one or more jobs that can run sequentially or in parallel</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a><span class="co">  # This workflow contains a single job called "build"</span></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="at">  </span><span class="fu">build-docs</span><span class="kw">:</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="co">    # The type of runner that the job will run on</span></span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co">    # Steps represent a sequence of tasks that will be executed as part of the job</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a><span class="co">      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it</span></span>
<span id="cb7-26"><a href="#cb7-26" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v2</span></span>
<span id="cb7-27"><a href="#cb7-27" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Sphinx Build</span></span>
<span id="cb7-29"><a href="#cb7-29" tabindex="-1"></a><span class="co">        # You may pin to the exact commit or the version.</span></span>
<span id="cb7-30"><a href="#cb7-30" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> ammaraskar/sphinx-action@0.4</span></span>
<span id="cb7-31"><a href="#cb7-31" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb7-32"><a href="#cb7-32" tabindex="-1"></a><span class="co">          # The folder containing your sphinx docs.</span></span>
<span id="cb7-33"><a href="#cb7-33" tabindex="-1"></a><span class="at">          </span><span class="fu">docs-folder</span><span class="kw">:</span><span class="at"> docs/</span></span>
<span id="cb7-34"><a href="#cb7-34" tabindex="-1"></a><span class="co">          # The command used to build your documentation.</span></span>
<span id="cb7-35"><a href="#cb7-35" tabindex="-1"></a><span class="at">          </span><span class="fu">build-command</span><span class="kw">:</span><span class="at"> make html</span></span>
<span id="cb7-36"><a href="#cb7-36" tabindex="-1"></a></span>
<span id="cb7-37"><a href="#cb7-37" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Archive documentation</span></span>
<span id="cb7-38"><a href="#cb7-38" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/upload-artifact@v2</span></span>
<span id="cb7-39"><a href="#cb7-39" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb7-40"><a href="#cb7-40" tabindex="-1"></a><span class="at">          </span><span class="fu">name</span><span class="kw">:</span><span class="at"> documentation-html</span></span>
<span id="cb7-41"><a href="#cb7-41" tabindex="-1"></a><span class="at">          </span><span class="fu">path</span><span class="kw">:</span><span class="at"> docs/build/</span></span></code></pre>
</div>
<p>If we save and wait for the triggered workflow to complete we should
see that the artifacts field is now 1, and that there is a new section
on our page which shows all the artifacts that were produced.</p>
<p><img src="fig/automation/worfklow-docs-with-artifact.png" alt="A successful workflow which has produced and artifact" class="figure"> ￼ We can
click on the <code>documentation-html</code> link to get a zip of the
<code>docs/build/</code> directory which contains all our
documentation.</p>
</div>
<div class="section level3">
<h3 id="summary-1">Summary<a class="anchor" aria-label="anchor" href="#summary-1"></a>
</h3>
<p>Building documentation requires a similar workflow to building and
testing code.</p>
<p>The GitHub marketplace offers a variety of pre-made ‘steps’ to
include in your workflow. There are many that will let you build
documentation with Sphinx.</p>
<p>When building documentation we need to ensure that the documentation
that was built is considered part of the workflow ‘artifact’ so that we
can download and view it after the workflow completes.</p>
<div id="solo-activity-github-actions" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<span class="callout-header">Discussion</span>
<div id="solo-activity-github-actions" class="callout-inner">
<h3 class="callout-title">SOLO Activity: GitHub actions</h3>
<div class="callout-content">
<p>In this activity you will apply the previous lessons to automate the
documentation and testing using GitHub actions. This activity can be
completed on your own solo project, or as part of a group project. The
requirements are that the project has a python module that can be
installed, has at least one function with a docstring, and at least one
test function.</p>
<ol style="list-style-type: decimal">
<li>For your software project create a GitHub action that will build and
test your python module.
<ol style="list-style-type: decimal">
<li>“Build” in this case means install the required dependencies and
then install your module using pip install -e .</li>
<li>The test phase can be carried out using either a test suite such as
pytest, or by running your test script directly. If you are using a
personal test script then you should ensure that it will exit with
status != 0 when the tests fail, so that the build/test workflow will
also report a failure.</li>
</ol>
</li>
<li>Use the GitHub online editor to create/modify the relevant .yml
files and set on status to be push so that the workflow will run each
time that you make changes to the .yml file.</li>
<li>Once you have a working build/test workflow, create a documentation
workflow.</li>
<li>Use the build/test workflow as a template and remove the test phase
and replace it with a documentation build.</li>
<li>Modify the documentation step such that it will produce an artefact
which is the contents of the documentation directory.</li>
<li>Verify that your documentation has completed properly by downloading
and viewing the workflow artefact.</li>
</ol>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section><section id="aio-SharingCode"><p>Content from <a href="SharingCode.html">Sharing Code To The Wider Community</a></p>
<hr>
<p>Last updated on 2026-02-27 |

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/episodes/SharingCode.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why should I share my code?</li>
<li>Where and how can I share my code?</li>
<li>How can I make my python code easy to obtain/install?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Have confidence to share your code</li>
<li>Make your code findable and accessible</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="publishing-code">‘Publishing’ code<a class="anchor" aria-label="anchor" href="#publishing-code"></a>
</h2>
<hr class="half-width">
<p>Once you have code that you are happy to share among collaborators
you should consider publishing this code.</p>
<p>What do we mean by publishing? From least to greatest effort, any of
the following could be considered as a definition for publishing
code:</p>
<ol style="list-style-type: decimal">
<li>Copying a version of your code to a public website for others to
find and use,</li>
<li>Making your version control repository (<a href="https://github.com/" class="external-link">github</a>, <a href="https://gitlab.com/" class="external-link">gitlab</a>, <a href="https://bitbucket.org/" class="external-link">bitbucket</a>) public so that others can
use and reuse your code,</li>
<li>Uploading your code to a repository such a <a href="http://pypi.org/" class="external-link">pypi.org</a> so that others can easily
download/install your software,</li>
<li>Archiving a version of your code to a doi minting / storage service
such as <a href="http://zenodo.org/" class="external-link">zenodo.org</a>,</li>
<li>Registering your code on a site such as <a href="http://ascl.net/" class="external-link">ascl.net</a> so that others can find your
code,</li>
<li>Writing a paper describing an application of your code and
submitting for peer review in a science focused journal such as <a href="https://www.cambridge.org/core/journals/publications-of-the-astronomical-society-of-australia" class="external-link">PASA</a>
or <a href="https://academic.oup.com/mnras" class="external-link">MNRAS</a>,</li>
<li>Writing a companion paper that describes your code and submitting
the paper and code for peer review in a software focused journal such as
<a href="https://www.journals.elsevier.com/astronomy-and-computing" class="external-link">A&amp;C</a>
or <a href="https://joss.theoj.org/" class="external-link">JOSS</a>. From the descriptions
above you can see that the different options have slightly different
intentions and audiences. We can take an lead from FAIR principles for
data, and apply these principles to code.</li>
</ol>
<div class="section level3">
<h3 id="findable">Findable<a class="anchor" aria-label="anchor" href="#findable"></a>
</h3>
<p>Make code findable by creating a persistent identifier (eg doi) and
including metadata. On pypi/zenodo/github you can use tags or topics to
identify the software language but also the area of research or
methodology that is being used. This makes it easier for people to find
code that will suit their needs.</p>
</div>
<div class="section level3">
<h3 id="accessible">Accessible<a class="anchor" aria-label="anchor" href="#accessible"></a>
</h3>
<p>Make code accessible by providing source code, install instructions,
and documentation. Testing code on a range of platforms will also
increase the accessibility of the code.</p>
</div>
<div class="section level3">
<h3 id="interoperable">Interoperable<a class="anchor" aria-label="anchor" href="#interoperable"></a>
</h3>
<p>Use standard project templates, coding styles and idioms, and a
modular design to allow your code to be used as part of a larger
workflow or as a component of another product. This interoperability is
useful for others, but will also make it easier for you to build on your
own existing solutions.</p>
</div>
<div class="section level3">
<h3 id="reusable">Reusable<a class="anchor" aria-label="anchor" href="#reusable"></a>
</h3>
<p>Make code reusable by providing a license, and indicating</p>
</div>
<div class="section level3">
<h3 id="reasons-not-to-publish">Reasons not to publish<a class="anchor" aria-label="anchor" href="#reasons-not-to-publish"></a>
</h3>
<p>The following are often given as reasons not to publish code:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr>
<th>Reason</th>
<th>Counter argument</th>
</tr></thead>
<tbody>
<tr>
<td>I don’t want to have to “support” my code.</td>
<td>Publishing code does not commit you to providing endless support. If
you do not intend to reply to emails, fix bugs, or make updates to the
code, simply say so in the README.md file. If this is the case you could
invite keen users to fork the repo and provide their own fixes.</td>
</tr>
<tr>
<td>I don’t want people to steal my good work.</td>
<td>With an appropriate license and attribution request, you can let
others use your work while you benefit from their reuse. If there is a
paper that describes or uses the code, you can ask for it to be cited by
others, and this will increase the impact of that paper (and your
h-index!).</td>
</tr>
<tr>
<td>My code is a bit hacky and I don’t want others to see it.</td>
<td>Being embarrassed about less-than-perfect code is normal. However, a
quick scan of GitHub will show you that hacked-together code is very
common even among professional developers. If your code serves it’s
intended purpose then it’s good enough to share. Consider writing a
short blurb in the README.md file that clearly state the intended aim of
the code, so that you can manage the expectations of your users.</td>
</tr>
<tr>
<td>I don’t know how to share my code.</td>
<td>It’s not difficult to share code, and it’s easy to learn. This
course is one of many (MANY) that take you through the steps of sharing
or publishing code. The small investment to learn how to share code will
pay off quickly when you start to discover and use code written by
others, get feedback and recognition for your code, or when your
computer dies and you need to recover your work.</td>
</tr>
<tr>
<td>My code contains sensitive IP that I’m not allowed to share.</td>
<td>Good argument! Keep it secure some place. Many of the steps that you
would take to prepare your data for publication are still worth doing to
make your code usable within your trusted network.</td>
</tr>
</tbody>
</table>
</div>
</section><section><h2 class="section-heading" id="obtaining-a-doi-from-zenodo-org">Obtaining a doi from Zenodo.org<a class="anchor" aria-label="anchor" href="#obtaining-a-doi-from-zenodo-org"></a>
</h2>
<hr class="half-width">
<p>You have a piece of code on github, but it is changing over time, and
you would like to provide a link to a particular version of the code.
This is important for reproducibility of your research work, both for
yourself and others.</p>
<p>The Zenodo repository provides a safe, trusted, and citable place to
host your code. Zenodo is primarily focused on the storage of data, but
this includes: documentation, papers, posters, raw or processed data,
source code, and compiled binaries. Zenodo will allow you to version
your data but does not provide a version control system such as git.
However, Zenodo and Github are friends so you can link them together to
get the best of both worlds.</p>
<div class="section level3">
<h3 id="sign-up-to-zenodo">Sign up to Zenodo<a class="anchor" aria-label="anchor" href="#sign-up-to-zenodo"></a>
</h3>
<p>You can create a new Zenodo account using an email address and
password, or you can use your <a href="https://github.com/" class="external-link">Github</a>
or <a href="https://orcid.org/" class="external-link">ORCID</a> accounts to login. Whatever
you choose, you can still link your github/ORCID later and use them to
sign in.</p>
</div>
<div class="section level3">
<h3 id="create-a-new-repository">Create a new repository<a class="anchor" aria-label="anchor" href="#create-a-new-repository"></a>
</h3>
<p>Once signed in click on the upload button at the top of the page, and
then on the next page click “New Upload”</p>
<figure><img src="fig/sharing/zenodo-banner.png" alt="The zenodo header with and upload link" class="figure mx-auto d-block"><div class="figcaption">The zenodo header with and upload link</div>
</figure><p>The following page will have a lot of details, some of which are
mandatory, but most of which are either recommended or optional. Begin
by downloading a .zip of your files from Github, and then uploading it
to Zenodo. Press the green “start upload” button and then start filling
out the rest of the form.</p>
<figure><img src="fig/sharing/uploading-to-zenodo.png" alt="Uploading your files to zenodo" class="figure mx-auto d-block"><div class="figcaption">Uploading your files to zenodo</div>
</figure><p>As the upload is progressing you can fill in the upload type
(Software) and basic information.</p>
<p>Leave the DOI blank, but click the “reserve DOI” button so that you
can know what the final DOI will be.</p>
<p>Fill in the remainder of the form and then press “save” at the top of
the page, this will make a draft of your repository that you can come
back to later and update. When you are finally happy with all the
details you can press ‘publish’.</p>
<p>Once your upload has been published you should navigate to the
published repository in your uploads list, and select it.</p>
<figure><img src="fig/sharing/example-zenodo-doi.png" alt="An example doi for published software on zenodo" class="figure mx-auto d-block"><div class="figcaption">An example doi for published software on
zenodo</div>
</figure><p>The above example is for the Aegean source finding software that I
developed. You can see the DOI badge with the full DOI, a link to
supplementary material, and the licence. If you click the DOI badge
you’ll get a new pane that shows you how to embed this information into
a markdown file such as your README.md that you have on your github
page!</p>
<p>Below this panel you can also see a box that allows people to cite
your code. There is even a box that allows people to get the citation in
any format that they need it.</p>
<figure><img src="fig/sharing/zenodo-citing.png" alt="How to cite from zenodo" class="figure mx-auto d-block"><div class="figcaption">How to cite from zenodo</div>
</figure><p>You now have a version of your code which is archived on zenodo and
will not change. If you want to update the archive with new versions of
the code, Zenodo has the capacity to do this, and will mint a new doi
for each version. It is recommended that you don’t make a new doi for
every small change you make to your code. A new version for each major
or minor version change would be appropriate, or when you have published
work that used a particular major/minor/patch version of the code.</p>
<p>Sadly Zenodo is not indexed by <a href="https://ui.adsabs.harvard.edu/" class="external-link">ADS</a> so you can’t track
citations very well from here.</p>
</div>
</section><section><h2 class="section-heading" id="registering-your-code-on-ascl-net">Registering your code on ascl.net<a class="anchor" aria-label="anchor" href="#registering-your-code-on-ascl-net"></a>
</h2>
<hr class="half-width">
<p>In the last lesson we saw how to obtain a DOI by uploading a software
project to Zenodo. In this lesson we’ll make an entry in the
Astrophysics Source Code Library (<a href="https://ascl.net/" class="external-link">ASCL.net</a>), which is indexed by ADS, and can
help you gain an audience, and track citations.</p>
<div class="section level3">
<h3 id="submit-a-code-to-ascl">Submit a code to ASCL<a class="anchor" aria-label="anchor" href="#submit-a-code-to-ascl"></a>
</h3>
<p>Go to the “submit a code” page <a href="https://ascl.net/code/submit" class="external-link">here</a>.</p>
<p>The page asks for a title, credit (authors/contributors), abstract,
and a site list for the code.</p>
<p>The site list should be a list of links to places where people can
obtain the code. I highly recommend that you put a link to both your
Github and Zenodo repositories. If the code was described in a paper you
can put that in the “Preferred Citation Method” section.</p>
<figure><img src="fig/sharing/ascl-submit.png" alt="Submitting to ASCL.net" class="figure mx-auto d-block"><div class="figcaption">Submitting to ASCL.net</div>
</figure><p>ASCL.net does not store your code. No one will vet the quality of
your code. ASCL.net is simply a place to register that some code exists
and that you’d like to be acknowledged for creating/contributing.
ASCL.net is indexed by ADS so it will get a bibcode in ADS, which can
then be used to generate a bibtex entry for people to use when citing
your code. Another goal of ASCL.net is to make it easier for people to
find your code in the first place. If you haven’t explored the code
available here I recommend that you do so now – there are some gems.</p>
<p>You can also get a nice little badge from ASCL to add to your
<code>README.md</code> file!</p>
</div>
</section><section><h2 class="section-heading" id="installing-your-module-via-setup-py">Installing your module via setup.py<a class="anchor" aria-label="anchor" href="#installing-your-module-via-setup-py"></a>
</h2>
<hr class="half-width">
<p>In our code directory we specified a <code>requirements.txt</code>
file that allowed users to easily installed the dependencies for our
code. However, if someone wants to run our main script
(<code>sim_catalog</code>) then they have to be in the code directory.
If we want to run the code from some other location on our system then
it won’t work. The reason is that we haven’t installed our code as a
python module.</p>
<p>Installing a python module will do the following:</p>
<ul>
<li>Copy the module directory and files (eg <code>skysim/*</code>) to a
central location so that python can access them no matter where it’s run
from,
<ul>
<li>something like
<code>/home/${USER}/.py3/lib/python3.8/site-packages/</code>;</li>
</ul>
</li>
<li>Copy and scripts (eg <code>sim_sky</code>) to a similar location so
that they can be invoked from anywhere,
<ul>
<li>something like <code>/home/${USER}/.py3/bin/</code>;</li>
</ul>
</li>
<li>Make a note that the module is installed,
<ul>
<li>so that <code>pip freeze</code> will report the name/version of the
software.</li>
</ul>
</li>
</ul>
<p>In order to install a python module you need a special file called
<code>setup.py</code>.</p>
<div class="section level3">
<h3 id="template-for-setup-py">Template for <code>setup.py</code>
<a class="anchor" aria-label="anchor" href="#template-for-setup-py"></a>
</h3>
<p>The <a href="https://docs.python.org/3/distutils/setupscript.html" class="external-link">python
documentation</a> covers all the gory details of the how and why of
using a <code>setup.py</code> file. However, a great place to start is
to use a template so we’ll provide one here to get started.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> setuptools</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> skysim</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"README.md"</span>, <span class="st">"r"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> fh:</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    long_description <span class="op">=</span> fh.read()</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'requirements.txt'</span>, <span class="st">'r'</span>) <span class="im">as</span> fh:</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    reqs <span class="op">=</span> [line <span class="cf">for</span> line <span class="kw">in</span> fh.readlines() <span class="cf">if</span> <span class="kw">not</span> line.startswith(<span class="st">'#'</span>)]</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>setuptools.setup(</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    name<span class="op">=</span><span class="st">"SkySim"</span>,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    version<span class="op">=</span>skysim.__version__,</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>    author<span class="op">=</span>skysim.__author__,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    author_email<span class="op">=</span><span class="st">"author@example.com"</span>,</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>    description<span class="op">=</span><span class="st">"Simulate sky locations"</span>,</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>    long_description<span class="op">=</span>long_description,</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    long_description_content_type<span class="op">=</span><span class="st">"text/markdown"</span>,</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    url<span class="op">=</span><span class="st">"https://github.com/DevOne/sky_sim"</span>,</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>    scripts<span class="op">=</span>[<span class="st">'scripts/sim_catalog'</span>],</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>    python_requires<span class="op">=</span><span class="st">"&gt;=3.6"</span>,</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>)</span></code></pre>
</div>
<p>Note the following:</p>
<ul>
<li>we import the <code>skysim</code> module so that we can read the
<code>__version__</code> and <code>__author__</code> information
directly,</li>
<li>we populate the <code>long_description</code> by reading the
<code>README.md</code> file,</li>
<li>we read the requirements from the <code>requirements.txt</code>
file,</li>
<li>we have set a minimum python version for this program, something
that we can’t do with a <code>requirements.txt</code> file,</li>
<li>we have moved the script sim_catalog from the root directory into
the <code>scripts/</code> directory.</li>
</ul>
<p>The above notes are in keeping with the good coding practice of not
repeating ourselves. All the information is stored in a single location
and duplication is minimised.</p>
</div>
<div class="section level3">
<h3 id="installing-the-module">Installing the module<a class="anchor" aria-label="anchor" href="#installing-the-module"></a>
</h3>
<p>For someone to install our software they should do one of the
following:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">git</span> clone git@github.com:<span class="op">&lt;</span>gituser<span class="op">&gt;</span>/<span class="op">&lt;</span>projectname<span class="op">&gt;</span>.git</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="ex">pip</span> install .</span></code></pre>
</div>
<p>or just download a <code>.zip</code> file from github, unzip it, and
then run <code>pip install .</code> in the same directory.</p>
<p>The final ‘<code>.</code>’ indicates that pip should install the
module defined in this directory. Pip will search for a
<code>setup.py</code> file for the required information.</p>
</div>
<div class="section level3">
<h3 id="uninstall-the-module">Uninstall the module<a class="anchor" aria-label="anchor" href="#uninstall-the-module"></a>
</h3>
<p>A user can uninstall the module from anywhere by running:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="ex">pip</span> uninstall SkySim</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="developer-mode">Developer mode<a class="anchor" aria-label="anchor" href="#developer-mode"></a>
</h3>
<p>As a developer it is annoying to have to uninstall/install your
module every time you make a change and want to check that things are
working. Pip has a nice solution to this which is a developer mode
install. Unlike a regular install, the developer mode will not copy
files to some python directory, but make symlinks instead. This means
that your changes to the files will be immediately used in the installed
version of the code. If you move or add files however, you’ll need to
uninstall/install the code again.</p>
<p>A developer mode install can be done using the <code>-e</code> flag
for pip:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-e</span> .</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="upgrading">Upgrading<a class="anchor" aria-label="anchor" href="#upgrading"></a>
</h3>
<p>If users want to upgrade the module they have to download or pull the
new version, uninstall the old one, and then install the new one. It can
be a little tedious and easy to forget. Luckily there is a python
package index <a href="http://pypi.org/" class="external-link">pypi.org</a> which pip can look
to in order to find different versions of your software. It is thanks to
pypi.org that pip knows how to install all the modules that we listed in
our <code>requirements.txt</code> file. We’ll explore the python package
index in the next lesson.</p>
</div>
</section><section><h2 class="section-heading" id="hosting-your-code-on-pypi-org">Hosting your code on pypi.org<a class="anchor" aria-label="anchor" href="#hosting-your-code-on-pypi-org"></a>
</h2>
<hr class="half-width">
<p>The python package index at <a href="http://pypi.org/" class="external-link">pypi.org</a>
is the first place that pip will look when asked to install a package.
If your package is avaialble via pypi.org then your users can install
your software simply by typing <code>pip install &lt;package&gt;</code>.
Installing from other locations is still possible and sometimes easy. In
this lesson we’ll go through the process of preparing your code and
uploading it to pypi.org. This content is based on the instructions at
<a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/" class="external-link">Packaging
Python Projects</a> (PyPA), which you should also refer to.</p>
<div class="section level3">
<h3 id="name-check">Name check<a class="anchor" aria-label="anchor" href="#name-check"></a>
</h3>
<p>Unlike GitHub where the project name is disambiguated based on the
project owner, pypi requires that each package have it’s own unique
name. So before you think about uploading your package to pypi.org you
should do a search to see if your package name is already in use, and
choose a new one if this is the case.</p>
<p>Once you have a name you like you should google it. This is what many
people will do when looking for your code and if the results that come
back are for a different software project (e.g. same name different
language), or are NSFW then people will be less likely to keep
looking.</p>
<p>You can choose nearly anything you like as the package name, however
<a href="https://www.python.org/dev/peps/pep-0423/" class="external-link">PEP423</a> has some
advice about how you might choose and structure your package name.</p>
</div>
<div class="section level3">
<h3 id="project-structure">Project structure<a class="anchor" aria-label="anchor" href="#project-structure"></a>
</h3>
<p>If you use the structure outline in <a href="PoC.html">Beginning a
new software project</a>, and have created a <code>setup.py</code> file
as described in <a href="SharingCode.html">Installing your module via
setup.py</a>, then you are good to go. The project structure recommended
in these lessons differs from that which is given on the PyPA site but
will still work.</p>
</div>
<div class="section level3">
<h3 id="project-metadata">Project metadata<a class="anchor" aria-label="anchor" href="#project-metadata"></a>
</h3>
<p>In addition to the meta data that we have already included in the
<code>setup.py</code> file we can include information that has special
meaning on the pypi site. This information is used to populate many of
the links on the landing page for a package. An example for the
<code>numpy</code> package is shown below:</p>
<figure><img src="fig/sharing/pypi-numpy.png" alt="Numpy package entry on pypi.org" class="figure mx-auto d-block"><div class="figcaption">Numpy package entry on pypi.org</div>
</figure><p>The information in the <strong>project description</strong> is
rendered from the <code>long_description</code> metadata using the
<code>long_description_content_type</code> to inform how the rendering
should be done. Many projects choose to copy their
<code>README.md</code> file into this field (as we did in a previous
lesson), however you can of course create a custom description for a
pypi audience.</p>
<p>The information in the <strong>project links</strong> section is
drawn from the <code>project_urls</code> dictionary. You can have any
description/links you like here. Some of the obvious ones get
appropriate icons but these cannot be customised.</p>
<p>Another sectionson the pypi landing page that you may want to
populate is “Classifiers”. For numpy they are shown below.</p>
<figure><img src="fig/sharing/pypi-numpy-classifiers.png" alt="The classifiers for numpy as shown on pypi.org" class="figure mx-auto d-block"><div class="figcaption">The classifiers for numpy as shown on
pypi.org</div>
</figure><p>The classifiers section helps people see additional metadata in a
regular format, and also allows people to search for other projects with
similar classifiers. Classifiers are specified as a list of strings in
the <code>classifiers</code> parameter within <code>setup.py</code>.
These classifiers can be changed for each release of a project. A list
of classifiers can be found at <a href="https://pypi.org/classifiers/" class="external-link">pypi.org/classifiers/</a>. It is a
long list, so maybe the first point of call would be to look at a
package like numpy or astropy that you think would have similar
classifiers and copy the relevant ones into your package.</p>
</div>
<div class="section level3">
<h3 id="building-a-distribution-package">Building a distribution package<a class="anchor" aria-label="anchor" href="#building-a-distribution-package"></a>
</h3>
<p>PyPA provides a package simply called <code>build</code> that will
create a package from your project. Install it using
<code>python3 -m pip install --upgrade build</code>, and then run it
using <code>python3 -m build</code>. It will create a directory called
<code>dist/</code> which contains a <code>.tar.gz</code> file (your
source archive) and a <code>.whl</code> file which is the build
distribution. Congratulations, you now have a package that can be served
by pypi – you just need a way to upload it.</p>
</div>
<div class="section level3">
<h3 id="uploading-to-pypi">Uploading to pypi<a class="anchor" aria-label="anchor" href="#uploading-to-pypi"></a>
</h3>
<p>The first thing that you need is to create an account on pypi.org.
Accounts are free and easy to make so go sign up <a href="https://pypi.org/account/register/" class="external-link">here</a>.</p>
<p>The second thing you’ll need is an API token. As noted on PyPA:</p>
<blockquote>
<p>To securely upload your project, you’ll need a PyPI API token. Create
one at <a href="https://test.pypi.org/manage/account/#api-tokens" class="external-link uri">https://test.pypi.org/manage/account/#api-tokens</a>,
setting the “Scope” to “Entire account”. Don’t close the page until you
have copied and saved the token — you won’t see that token again.</p>
<p><a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/" class="external-link uri">https://packaging.python.org/en/latest/tutorials/packaging-projects/</a></p>
</blockquote>
<p>Uploading to pypi is handled by the <code>twine</code> module which
can be installed using
<code>python3 -m pip install --upgrade twine</code>.</p>
<p>To upload your package use:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">python3</span> <span class="at">-m</span> twine upload dist/<span class="pp">*</span></span></code></pre>
</div>
<p>When prompted for a username you should use <code>__token__</code>
and for your password you should use
<code>pypi-&lt;API_Token_Value&gt;</code>.</p>
<p>If you want to test that your upload will work and see what the page
would look like without placing it on the main package index you can use
the test repository. To do this just add
<code>--repository testpypi</code> after <code>twine</code> in the above
command. When you upload to the test repository you can see the results
at
<code>https://test.pypi.org/project/example-pkg-YOUR-USERNAME-HERE</code>.
This test site is good to use for the first time you are uploading as
you’ll invariably want to make some small changes once you’ve seen how
the landing page renders.</p>
<p>Congratulations, you now have a package published in the python
package index. For more details and some alternatives to the method
given above you are referred to the <a href="https://packaging.python.org/en/latest/tutorials/packaging-projects/" class="external-link">PyPA
tutorial</a>.</p>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-4">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/PaulHancock/Lesson-Testing/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/PaulHancock/Lesson-Testing/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/PaulHancock/Lesson-Testing/" class="external-link">Source</a></p>
        <p>
        <a href="citation.html">Cite</a>
        | <a href="mailto:paul.hancock@curtin.edu.au">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
		</div>
		<div class="col-md-4" align="center">
  			<a title="GDPR-compliant Web Analytics" href="https://clicky.com/101447658" class="external-link"><img alt="Clicky" src="//static.getclicky.com/media/links/badge.gif" border="0"></a>
      		<script async data-id="101447658" src="//static.getclicky.com/js"></script>
</div>
		<div class="col-md-4">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/" class="external-link">sandpaper (0.18.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/" class="external-link">pegboard (0.7.9)</a>, and <a href="https://github.com/PaulHancock/varnish/tree/898c5b9e154af89781a63e65953503291bb50645" class="external-link">varnish (1.0.9)</a></p>
		</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "LearningResource",
  "@id": "https://PaulHancock.github.io/Lesson-Testing/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/LearningResource/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, machine learning, AI, astronomy",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://PaulHancock.github.io/Lesson-Testing/aio.html",
  "identifier": "https://PaulHancock.github.io/Lesson-Testing/aio.html",
  "dateCreated": "2026-02-23",
  "dateModified": "2026-02-27",
  "datePublished": "2026-02-27"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

